filter(Day_Trmt %in% c('Day7_Primary_AvM', 'Day14_Primary_AvM', 'Day21_Primary_AvM')) %>%
filter(down == TRUE) %>%
filter(Row.names %in% Contant_dwnreg$Row.names) %>% # call only rownames (Gene IDs) from the constant downreg dataset (8 total)
group_by(Row.names) %>%
dplyr::summarise(Freq = n(), # should be 3 for all - just a quick check that this works...
mean.LFC = mean(log2FoldChange),
sd.LFC = sd(log2FoldChange)) %>%
arrange(desc(mean.LFC))
Mean.LFC_upreg <- All_DEGs_Primary.Ambieant_v_Moderate %>%
filter(Day_Trmt %in% c('Day7_Primary_AvM', 'Day14_Primary_AvM', 'Day21_Primary_AvM')) %>%
filter(up == TRUE) %>%
filter(Row.names %in% Contant_upreg$Row.names) %>% # call only rownames (Gene IDs) from the constant downreg dataset (8 total)
group_by(Row.names) %>%
dplyr::summarise(Freq = n(), # should be 3 for all - just a quick check that this works...
mean.LFC = mean(log2FoldChange),
sd.LFC = sd(log2FoldChange)) %>%
arrange(desc(mean.LFC))
# build annotation file to merge with the mean LFC tables
annot.condenced <- Geoduck_annotation[,c(1,3:9)]
annot.condenced$gene.length <- annot.condenced$V4 - annot.condenced$V3
annot.condenced <- annot.condenced[,-c(2,3)]
names(annot.condenced) <- c('Gene.ID', 'Uniprot', 'HGNC', 'fxn', 'Go.terms', 'Go.fxns','gene.length')
# merge LFC mean constant primary genes with the annotation file
names(Mean.LFC_upreg)[1] <- "Gene.ID" # first change the name from Row.names
names(Mean.LFC_downreg)[1] <- "Gene.ID" # first change the name from Row.names
LFC_ALL.constant.primary <- rbind(Mean.LFC_upreg, Mean.LFC_downreg) # bind these
Constant.primary.MASTER <- merge(LFC_ALL.constant.primary, annot.condenced, by ="Gene.ID") # merge with the annotation for Go HGNC, fxn, gene length, etc.
write.csv(Constant.primary.MASTER,paste(path_out,"Constant.Primary_master.csv"))
# call the GO terms
Geoduck_GOterms <- as.data.frame(Geoduck_annotation) %>% dplyr::select(c('V1','V8'))
colnames(Geoduck_GOterms)[1:2] <- c('transcript.ID', 'GO.terms') # call gene name and the GO terms - (Uniprot ID 'V5')
splitted <- strsplit(as.character(Geoduck_GOterms$GO.terms), "; ") #slit into multiple GO ids by delimiter'; ' remember the space after ; is needed here! without this you will only call the first listed GO term for each gene!
GO.terms <- data.frame(v1 = rep.int(Geoduck_GOterms$transcript.ID, sapply(splitted, length)), v2 = unlist(splitted)) #list all genes with each of their GO terms in a single row
# Prepare dataframe(s) and vectors for goseq
# Format 'GO.term' for goseq from the P.generosa annotation .fna file 'Geoduck_annotation'
IDvector.d0 <- as.vector(unique(Day0_all.counts$gene.ID))   # call unique genes (those filtered and used in DESEq2) on day0 - 'IDvector'
IDvector.d7 <- as.vector(unique(Day7_all.counts$gene.ID))  # call unique genes (those filtered and used in DESEq2) on day7 - 'IDvector'
IDvector.d14 <- as.vector(unique(Day14_all.counts$gene.ID)) # call unique genes (those filtered and used in DESEq2) on day14 - 'IDvector'
IDvector.d21 <- as.vector(unique(Day21_all.counts$gene.ID)) # call unique genes (those filtered and used in DESEq2) on day21 - 'IDvector'
GO_unique.genes.all <- as.vector(unique(Geoduck_annotation$V1)) # call all unique genes for GO analysis (goseq)
# Gene length
GO_gene.length <- Geoduck_annotation %>% dplyr::mutate(length = V4-V3) %>%  dplyr::select(c("V1","length"))
names(GO_gene.length)[1] <- "gene.ID" # cange the column name to merge with the gene counts on each day to call ID and length vectors UNIQUE to the experiment day
# merge length with counts data
length_vector   <- GO_gene.length$length
GeneLength.d0   <- merge(GO_gene.length, Day0_all.counts, by = "gene.ID")   # merge day0 counts with 'GO_gene.length'
GeneLength.d7   <- merge(GO_gene.length, Day7_all.counts, by = "gene.ID")  # merge day7 counts with 'GO_gene.length'
GeneLength.d14  <- merge(GO_gene.length, Day14_all.counts, by = "gene.ID")  # merge day14 counts with 'GO_gene.length'
GeneLength.d21  <- merge(GO_gene.length, Day21_all.counts, by = "gene.ID")  # merge day21 counts with 'GO_gene.length'
# call length values for goseq - confirms that the IDvector and length_vector are the same!!!
length_vector.d0 <- GeneLength.d0$length    # length vector for all unique reads address in DESeq2 on day 0
sum(sapply(length_vector.d0,length)) == dim(Day0_all.counts)[1] #should be TRUE
length_vector.d7 <- GeneLength.d7$length    # length vector for all unique reads address in DESeq2 on day 7
sum(sapply(length_vector.d7,length)) == dim(Day7_all.counts)[1] #should be TRUE
length_vector.d14 <- GeneLength.d14$length  # length vector for all unique reads address in DESeq2 on day 14
sum(sapply(length_vector.d14,length)) == dim(Day14_all.counts)[1] #should be TRUE
length_vector.d21 <- GeneLength.d21$length  # length vector for all unique reads address in DESeq2 on day 21
sum(sapply(length_vector.d21,length)) == dim(Day21_all.counts)[1] #should be TRUE
# (1) DEGs: Primary Ambient_v_Moderate
# DAY 0 ------------------------------------------- #
# DE.d0._Primary.UP    <-as.integer(IDvector.d0%in%(DE_d0.primary.UPREG$gene.ID)) # Day 0 - Primary - Upregulated DEGs
# names(DE.d0._Primary.UP)=IDvector.d0
DE.d0._Primary.UP    <-as.integer(GO_unique.genes.all%in%(DE_d0.primary.UPREG$gene.ID)) # Day 0 - Primary - Upregulated DEGs
names(DE.d0._Primary.UP)=GO_unique.genes.all
sum(sapply(DE.d0._Primary.UP,length)) # 34947 (9207 if you use the ID vecotr specific to filtered genes at Day 0)
sum(DE.d0._Primary.UP == 1) # should be 11
# DE.d0._Primary.DOWN  <-as.integer(IDvector.d0%in%(DE_d0.primary.DWNREG$gene.ID)) # Day 0 - Primary - Downregulated DEGs
# names(DE.d0._Primary.DOWN)=IDvector.d0
DE.d0._Primary.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d0.primary.DWNREG$gene.ID)) # Day 0 - Primary - Downregulated DEGs
names(DE.d0._Primary.DOWN)=GO_unique.genes.all
sum(sapply(DE.d0._Primary.DOWN,length)) # 34947 (9207 if you use the ID vecotr specific to filtered genes at Day 0)
sum(DE.d0._Primary.DOWN == 1) # should be 3
# DE.d0._Primary.ALL   <-as.integer(IDvector.d0%in%(DE_d0.primary$gene.ID)) # Day 0 - Primary - All DEGs
# names(DE.d0._Primary.ALL)=IDvector.d0
DE.d0._Primary.ALL   <-as.integer(GO_unique.genes.all%in%(DE_d0.primary$gene.ID)) # Day 0 - Primary - All DEGs
names(DE.d0._Primary.ALL)=GO_unique.genes.all
sum(sapply(DE.d0._Primary.ALL,length)) # 34947 (9207 if you use the ID vecotr specific to filtered genes at Day 0)
sum(DE.d0._Primary.ALL == 1) # should be 14
# DAY 7 ------------------------------------------- #
# DE.d7._Primary.UP    <-as.integer(IDvector.d7%in%DE_d7.primary.UPREG$gene.ID) # Day 7 - Primary - Upregulated DEGs
# names(DE.d7._Primary.UP)=IDvector.d7
DE.d7._Primary.UP    <-as.integer(GO_unique.genes.all%in%DE_d7.primary.UPREG$gene.ID) # Day 7 - Primary - Upregulated DEGs
names(DE.d7._Primary.UP)=GO_unique.genes.all
sum(sapply(DE.d7._Primary.UP,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7._Primary.UP == 1) # should be 62
# DE.d7._Primary.DOWN  <-as.integer(IDvector.d7%in%(DE_d7.primary.DWNREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
# names(DE.d7._Primary.DOWN)=IDvector.d7
DE.d7._Primary.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d7.primary.DWNREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
names(DE.d7._Primary.DOWN)=GO_unique.genes.all
sum(sapply(DE.d7._Primary.DOWN,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7._Primary.DOWN == 1) # should be 46
# DE.d7._Primary.ALL   <-as.integer(IDvector.d7%in%(DE_d7.primary$gene.ID)) # Day 7 - Primary - All DEGs
# names(DE.d7._Primary.ALL)=IDvector.d7
DE.d7._Primary.ALL   <-as.integer(GO_unique.genes.all%in%(DE_d7.primary$gene.ID)) # Day 7 - Primary - All DEGs
names(DE.d7._Primary.ALL)=GO_unique.genes.all
sum(sapply(DE.d7._Primary.ALL,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7._Primary.ALL == 1) # should be 108
DE.d7._Second.UPREG  <-as.integer(GO_unique.genes.all%in%(DE_d7.second.UPREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
names(DE.d7._Second.UPREG)=GO_unique.genes.all
sum(sapply(DE.d7._Second.UPREG,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7._Second.UPREG == 1) # should be 14
DE.d7._Second.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d7.second.DWNREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
names(DE.d7._Second.DOWN)=GO_unique.genes.all
sum(sapply(DE.d7._Second.DOWN,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7._Second.DOWN == 1) # should be 92
DE.d7.MA_AM.UPREG  <-as.integer(GO_unique.genes.all%in%(DE_d7.MA_AM.UPREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
names(DE.d7.MA_AM.UPREG)=GO_unique.genes.all
sum(sapply(DE.d7.MA_AM.UPREG,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7.MA_AM.UPREG == 1) # should be 31
DE.d7.MA_AM.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d7.MA_AM.DWNREG$gene.ID)) # Day 7 - Primary - Downregulated DEGs
names(DE.d7.MA_AM.DOWN)=GO_unique.genes.all
sum(sapply(DE.d7.MA_AM.DOWN,length)) # 34947 (8548 if you use the ID vecotr specific to filtered genes at Day 7)
sum(DE.d7.MA_AM.DOWN == 1) # should be 137
# DAY 14 ------------------------------------------- #
# DE.d14._Primary.UP    <-as.integer(IDvector.d14%in%(DE_d14.primary.UPREG$gene.ID)) # Day 14 - Primary - Upregulated DEGs
# names(DE.d14._Primary.UP)=IDvector.d14
DE.d14._Primary.UP    <-as.integer(GO_unique.genes.all%in%(DE_d14.primary.UPREG$gene.ID)) # Day 14 - Primary - Upregulated DEGs
names(DE.d14._Primary.UP)=GO_unique.genes.all
sum(sapply(DE.d14._Primary.UP,length)) # 34947 (8626 if you use the ID vecotr specific to filtered genes at Day 14)
sum(DE.d14._Primary.UP == 1) # should be 317
# DE.d14._Primary.DOWN  <-as.integer(IDvector.d14%in%(DE_d14.primary.DWNREG$gene.ID)) # Day 14 - Primary - Downregulated DEGs
# names(DE.d14._Primary.DOWN)=IDvector.d14
DE.d14._Primary.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d14.primary.DWNREG$gene.ID)) # Day 14 - Primary - Downregulated DEGs
names(DE.d14._Primary.DOWN)=GO_unique.genes.all
sum(sapply(DE.d14._Primary.DOWN,length)) # 34947 (8626 if you use the ID vecotr specific to filtered genes at Day 14)
sum(DE.d14._Primary.DOWN == 1) # should be 112
# DE.d14._Primary.ALL   <-as.integer(IDvector.d14%in%(DE_d14.primary$gene.ID)) # Day 14 - Primary - All DEGs
# names(DE.d14._Primary.ALL)=IDvector.d14
DE.d14._Primary.ALL   <-as.integer(GO_unique.genes.all%in%(DE_d14.primary$gene.ID)) # Day 14 - Primary - All DEGs
names(DE.d14._Primary.ALL)=GO_unique.genes.all
sum(sapply(DE.d14._Primary.ALL,length)) # 34947 (8626 if you use the ID vecotr specific to filtered genes at Day 14)
sum(DE.d14._Primary.ALL == 1) # should be 429
# DAY 21 ------------------------------------------- #
# DE.d21._Primary.UP    <-as.integer(IDvector.d21%in%(DE_d21.primary.UPREG$gene.ID)) # Day 21 - Primary - Upregulated DEGs
# names(DE.d21._Primary.UP)=IDvector.d21
DE.d21._Primary.UP    <-as.integer(GO_unique.genes.all%in%(DE_d21.primary.UPREG$gene.ID)) # Day 21 - Primary - Upregulated DEGs
names(DE.d21._Primary.UP)=GO_unique.genes.all
sum(sapply(DE.d21._Primary.UP,length)) # 34947 (8421 if you use the ID vecotr specific to filtered genes at Day 21)
sum(DE.d21._Primary.UP == 1) # should be 101
# DE.d21._Primary.DOWN  <-as.integer(IDvector.d21%in%(DE_d21.primary.DWNREG$gene.ID)) # Day 21 - Primary - Downregulated DEGs
# names(DE.d21._Primary.DOWN)=IDvector.d21
DE.d21._Primary.DOWN  <-as.integer(GO_unique.genes.all%in%(DE_d21.primary.DWNREG$gene.ID)) # Day 21 - Primary - Downregulated DEGs
names(DE.d21._Primary.DOWN)=GO_unique.genes.all
sum(sapply(DE.d21._Primary.DOWN,length)) # 34947 (8421 if you use the ID vecotr specific to filtered genes at Day 21)
sum(DE.d21._Primary.DOWN == 1) # should be 54
# DE.d21._Primary.ALL   <-as.integer(IDvector.d21%in%(DE_d21.primary$gene.ID)) # Day 21 - Primary - All DEGs
# names(DE.d21._Primary.ALL)=IDvector.d21
DE.d21._Primary.ALL   <-as.integer(GO_unique.genes.all%in%(DE_d21.primary$gene.ID)) # Day 21 - Primary - All DEGs
names(DE.d21._Primary.ALL)=GO_unique.genes.all
sum(sapply(DE.d21._Primary.ALL,length)) # 34947 (8421 if you use the ID vecotr specific to filtered genes at Day 21)
sum(DE.d21._Primary.ALL == 1) # should be 155
#Constant DEGs ------------------------------------ #
# Note: these are degenes that were upregulated and downregulated throughout the 21-day experiment due to the effect of primary treatment
# data from the cluster {r Primary_Treatment_constant_DEGs}
DE_Contant_upreg <-as.integer(GO_unique.genes.all%in%(Contant_upreg$Row.names)) # Day 0 - Primary - All DEGs
names(DE_Contant_upreg)=GO_unique.genes.all
sum(DE_Contant_upreg == 1) # should be 14
DE_Contant_dwnreg <-as.integer(GO_unique.genes.all%in%(Contant_dwnreg$Row.names)) # Day 0 - Primary - All DEGs
names(DE_Contant_dwnreg)=GO_unique.genes.all
sum(DE_Contant_dwnreg == 1) # should be  8
#Calculate Probability Weighting Function (using 'nullp')
# (1) DEGs: Primary Ambient_v_Moderate
# DAY 0 ------------------------------------------- #
# DEG.pwf_d0.all    <-nullp(DE.d0._Primary.ALL,   id=IDvector.d0, bias.data=length_vector.d0) #weight vector by length of gene
# DEG.pwf_d0.UP     <-nullp(DE.d0._Primary.UP,    id=IDvector.d0, bias.data=length_vector.d0) #weight vector by length of gene
# DEG.pwf_d0.DOWN   <-nullp(DE.d0._Primary.DOWN,  id=IDvector.d0, bias.data=length_vector.d0) #weight vector by length of gene
DEG.pwf_d0.all    <-nullp(DE.d0._Primary.ALL,   id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d0.UP     <-nullp(DE.d0._Primary.UP,    id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d0.DOWN   <-nullp(DE.d0._Primary.DOWN,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
# DAY 7 ------------------------------------------- #
# DEG.pwf_d7.all    <-nullp(DE.d7._Primary.ALL,   id=IDvector.d7, bias.data=length_vector.d7) #weight vector by length of gene
# DEG.pwf_d7.UP     <-nullp(DE.d7._Primary.UP,    id=IDvector.d7, bias.data=length_vector.d7) #weight vector by length of gene
# DEG.pwf_d7.DOWN   <-nullp(DE.d7._Primary.DOWN,  id=IDvector.d7, bias.data=length_vector.d7) #weight vector by length of gene
DEG.pwf_d7.all    <-nullp(DE.d7._Primary.ALL,   id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.UP     <-nullp(DE.d7._Primary.UP,    id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.DOWN   <-nullp(DE.d7._Primary.DOWN,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.UP_second     <-nullp(DE.d7._Second.UPREG,    id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.DOWN_second   <-nullp(DE.d7._Second.DOWN,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.UP_MA_AM     <-nullp(DE.d7.MA_AM.UPREG,    id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d7.DOWN_MA_AM   <-nullp(DE.d7.MA_AM.DOWN,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
# DAY 14 ------------------------------------------- #
# DEG.pwf_d14.all   <-nullp(DE.d14._Primary.ALL,  id=IDvector.d14, bias.data=length_vector.d14) #weight vector by length of gene
# DEG.pwf_d14.UP    <-nullp(DE.d14._Primary.UP,   id=IDvector.d14, bias.data=length_vector.d14) #weight vector by length of gene
# DEG.pwf_d14.DOWN  <-nullp(DE.d14._Primary.DOWN, id=IDvector.d14, bias.data=length_vector.d14) #weight vector by length of gene
DEG.pwf_d14.all   <-nullp(DE.d14._Primary.ALL,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d14.UP    <-nullp(DE.d14._Primary.UP,   id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d14.DOWN  <-nullp(DE.d14._Primary.DOWN, id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
# DAY 21 ------------------------------------------- #
# DEG.pwf_d21.all   <-nullp(DE.d21._Primary.ALL,  id=IDvector.d21, bias.data=length_vector.d21) #weight vector by length of gene
# DEG.pwf_d21.UP    <-nullp(DE.d21._Primary.UP,   id=IDvector.d21, bias.data=length_vector.d21) #weight vector by length of gene
# DEG.pwf_d21.DOWN  <-nullp(DE.d21._Primary.DOWN, id=IDvector.d21, bias.data=length_vector.d21) #weight vector by length of gene
DEG.pwf_d21.all   <-nullp(DE.d21._Primary.ALL,  id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d21.UP    <-nullp(DE.d21._Primary.UP,   id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_d21.DOWN  <-nullp(DE.d21._Primary.DOWN, id=GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
# Constant DEGs ------------------------------------ #
DEG.pwf_Constant.UP   <- nullp(DE_Contant_upreg, GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
DEG.pwf_Constant.DOWN <- nullp(DE_Contant_dwnreg, GO_unique.genes.all, bias.data=length_vector) #weight vector by length of gene
# (1) DEGs: Primary Ambient_v_Moderate
# DAY 0 ------------------------------------------- #
GO_d0.all    <-goseq(DEG.pwf_d0.all,  GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d0.UP     <-goseq(DEG.pwf_d0.UP,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d0.DOWN   <-goseq(DEG.pwf_d0.DOWN, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
# DAY 7 ------------------------------------------- #
GO_d7.all    <-goseq(DEG.pwf_d7.all,  GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.UP     <-goseq(DEG.pwf_d7.UP,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.DOWN   <-goseq(DEG.pwf_d7.DOWN, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.UP_SECOND     <-goseq(DEG.pwf_d7.UP_second,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.DOWN_SECOND     <-goseq(DEG.pwf_d7.DOWN_second,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.UP_MA_AM    <-goseq(DEG.pwf_d7.UP_MA_AM,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d7.DOWN_MA_AM    <-goseq(DEG.pwf_d7.DOWN_MA_AM,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
# DAY 14 ------------------------------------------- #
GO_d14.all   <-goseq(DEG.pwf_d14.all,  GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d14.UP    <-goseq(DEG.pwf_d14.UP,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d14.DOWN  <-goseq(DEG.pwf_d14.DOWN, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
# DAY 21 ------------------------------------------- #
GO_d21.all   <-goseq(DEG.pwf_d21.all,  GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d21.UP    <-goseq(DEG.pwf_d21.UP,   GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_d21.DOWN  <-goseq(DEG.pwf_d21.DOWN, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
# Constant DEGs ------------------------------------ #
GO_Constant.UP   <- goseq(DEG.pwf_Constant.UP, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
GO_Constant.DOWN <- goseq(DEG.pwf_Constant.DOWN, GO_unique.genes.all, gene2cat=GO.terms, test.cats=c("GO:CC", "GO:BP", "GO:MF"), method="Wallenius", use_genes_without_cat=TRUE)
# Day0 Primary Treatment effect  ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
# UPREGULATED GENES - those with higher expression from ambient (control) stress priming
d0.UP.05<-GO_d0.UP$category[GO_d0.UP$over_represented_pvalue<.05]
d0.UP.05<-data.frame(d0.UP.05)
colnames(d0.UP.05) <- c("category")
d0.UP.05 <- merge(d0.UP.05, GO_d0.UP, by="category")
d0.UP.05 <- d0.UP.05[order(d0.UP.05$ontology, d0.UP.05$over_represented_pvalue, -d0.UP.05$numDEInCat),]
d0.UP.05$term <- as.factor(d0.UP.05$term)
d0.UP.05_filtered <- d0.UP.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d0.UP.05_filtered, ontology=="BP")) #number sig BP terms == 7
nrow(filter(d0.UP.05_filtered, ontology=="MF")) #number sig MF terms == 5
nrow(d0.UP.05_filtered) # == 12
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d0.DOWN.05<-GO_d0.DOWN$category[GO_d0.DOWN$over_represented_pvalue<.05]
d0.DOWN.05<-data.frame(d0.DOWN.05)
colnames(d0.DOWN.05) <- c("category")
d0.DOWN.05 <- merge(d0.DOWN.05, GO_d0.DOWN, by="category")
d0.DOWN.05 <- d0.DOWN.05[order(d0.DOWN.05$ontology, d0.DOWN.05$over_represented_pvalue, -d0.DOWN.05$numDEInCat),]
d0.DOWN.05$term <- as.factor(d0.DOWN.05$term)
d0.DOWN.05_filtered <- d0.DOWN.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d0.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 7
nrow(filter(d0.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 5
nrow(d0.DOWN.05_filtered) # == 12
# Day7 Primary Treatment effect ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
# UPREGULATED GENES - those with higher expression from ambient (control) stress priming
d7.UP.05<-GO_d7.UP$category[GO_d7.UP$over_represented_pvalue<.05]
d7.UP.05<-data.frame(d7.UP.05)
colnames(d7.UP.05) <- c("category")
d7.UP.05 <- merge(d7.UP.05, GO_d7.UP, by="category")
d7.UP.05 <- d7.UP.05[order(d7.UP.05$ontology, d7.UP.05$over_represented_pvalue, -d7.UP.05$numDEInCat),]
d7.UP.05$term <- as.factor(d7.UP.05$term)
d7.UP.05_filtered <- d7.UP.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.UP.05_filtered, ontology=="BP")) #number sig BP terms == 85
nrow(filter(d7.UP.05_filtered, ontology=="MF")) #number sig MF terms == 28
nrow(d7.UP.05_filtered) # == 128
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d7.DOWN.05<-GO_d7.DOWN$category[GO_d7.DOWN$over_represented_pvalue<.05]
d7.DOWN.05<-data.frame(d7.DOWN.05)
colnames(d7.DOWN.05) <- c("category")
d7.DOWN.05 <- merge(d7.DOWN.05, GO_d7.DOWN, by="category")
d7.DOWN.05 <- d7.DOWN.05[order(d7.DOWN.05$ontology, d7.DOWN.05$over_represented_pvalue, -d7.DOWN.05$numDEInCat),]
d7.DOWN.05$term <- as.factor(d7.DOWN.05$term)
d7.DOWN.05_filtered <- d7.DOWN.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 40
nrow(filter(d7.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 15
nrow(d7.DOWN.05_filtered) # == 60
# Day 7 seccond treament effect  ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;
# SCOND TREATMETN EFFECT AMBIENT V MODERATE
d7.UP.05_second<-GO_d7.UP_SECOND$category[GO_d7.UP_SECOND$over_represented_pvalue<.05]
d7.UP.05_second<-data.frame(d7.UP.05_second)
colnames(d7.UP.05_second) <- c("category")
d7.UP.05_second <- merge(d7.UP.05_second, GO_d7.UP_SECOND, by="category")
d7.UP.05_second <- d7.UP.05_second[order(d7.UP.05_second$ontology, d7.UP.05_second$over_represented_pvalue, -d7.UP.05_second$numDEInCat),]
d7.UP.05_second$term <- as.factor(d7.UP.05_second$term)
d7.UP.05_second_filtered <- d7.UP.05_second %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.UP.05_second_filtered, ontology=="BP")) #number sig BP terms == 0
nrow(filter(d7.UP.05_second_filtered, ontology=="MF")) #number sig MF terms == 1
nrow(d7.UP.05_second_filtered) # == 19
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d7.DOWN.05_second<-GO_d7.DOWN_SECOND$category[GO_d7.DOWN_SECOND$over_represented_pvalue<.05]
d7.DOWN.05_second<-data.frame(d7.DOWN.05_second)
colnames(d7.DOWN.05_second) <- c("category")
d7.DOWN.05_second <- merge(d7.DOWN.05_second, GO_d7.DOWN_SECOND, by="category")
d7.DOWN.05_second <- d7.DOWN.05_second[order(d7.DOWN.05_second$ontology, d7.DOWN.05_second$over_represented_pvalue, -d7.DOWN.05_second$numDEInCat),]
d7.DOWN.05_second$term <- as.factor(d7.DOWN.05_second$term)
d7.DOWN.05_second_filtered <- d7.DOWN.05_second %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.DOWN.05_second_filtered, ontology=="BP")) #number sig BP terms == 33
nrow(filter(d7.DOWN.05_second_filtered, ontology=="MF")) #number sig MF terms == 16
nrow(d7.DOWN.05_second_filtered) # == 76
# FULL TREATMETN HISTORY EFFECT MA VS. AM (AT DAY 7)
d7.UP.05_MA_AM<-GO_d7.UP_MA_AM$category[GO_d7.UP_MA_AM$over_represented_pvalue<.05]
d7.UP.05_MA_AM<-data.frame(d7.UP.05_MA_AM)
colnames(d7.UP.05_MA_AM) <- c("category")
d7.UP.05_MA_AM <- merge(d7.UP.05_MA_AM, GO_d7.UP_MA_AM, by="category")
d7.UP.05_MA_AM <- d7.UP.05_MA_AM[order(d7.UP.05_MA_AM$ontology, d7.UP.05_MA_AM$over_represented_pvalue, -d7.UP.05_MA_AM$numDEInCat),]
d7.UP.05_MA_AM$term <- as.factor(d7.UP.05_MA_AM$term)
d7.UP.05_MA_AM_filtered <- d7.UP.05_MA_AM %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.UP.05_MA_AM_filtered, ontology=="BP")) #number sig BP terms == 3
nrow(filter(d7.UP.05_MA_AM_filtered, ontology=="MF")) #number sig MF terms == 0
nrow(d7.UP.05_MA_AM_filtered) # == 11
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d7.DOWN.05_MA_AM<-GO_d7.DOWN_MA_AM$category[GO_d7.DOWN_MA_AM$over_represented_pvalue<.05]
d7.DOWN.05_MA_AM<-data.frame(d7.DOWN.05_MA_AM)
colnames(d7.DOWN.05_MA_AM) <- c("category")
d7.DOWN.05_MA_AM <- merge(d7.DOWN.05_MA_AM, GO_d7.DOWN_MA_AM, by="category")
d7.DOWN.05_MA_AM <- d7.DOWN.05_MA_AM[order(d7.DOWN.05_MA_AM$ontology, d7.DOWN.05_MA_AM$over_represented_pvalue, -d7.DOWN.05_MA_AM$numDEInCat),]
d7.DOWN.05_MA_AM$term <- as.factor(d7.DOWN.05_MA_AM$term)
d7.DOWN.05_MA_AM_filtered <- d7.DOWN.05_MA_AM %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d7.DOWN.05_MA_AM_filtered, ontology=="BP")) #number sig BP terms == 39
nrow(filter(d7.DOWN.05_MA_AM_filtered, ontology=="MF")) #number sig MF terms == 17
nrow(d7.DOWN.05_MA_AM_filtered) # == 89
# Day14 Primary Treatment effect
# UPREGULATED GENES - those with higher expression from ambient (control) stress priming
d14.UP.05<-GO_d14.UP$category[GO_d14.UP$over_represented_pvalue<.05]
d14.UP.05<-data.frame(d14.UP.05)
colnames(d14.UP.05) <- c("category")
d14.UP.05 <- merge(d14.UP.05, GO_d14.UP, by="category")
d14.UP.05 <- d14.UP.05[order(d14.UP.05$ontology, d14.UP.05$over_represented_pvalue, -d14.UP.05$numDEInCat),]
d14.UP.05$term <- as.factor(d14.UP.05$term)
d14.UP.05_filtered <- d14.UP.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d14.UP.05_filtered, ontology=="BP")) #number sig BP terms == 119
nrow(filter(d14.UP.05_filtered, ontology=="MF")) #number sig MF terms == 62
nrow(d14.UP.05_filtered) # == 208
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d14.DOWN.05<-GO_d14.DOWN$category[GO_d14.DOWN$over_represented_pvalue<.05]
d14.DOWN.05<-data.frame(d14.DOWN.05)
colnames(d14.DOWN.05) <- c("category")
d14.DOWN.05 <- merge(d14.DOWN.05, GO_d14.DOWN, by="category")
d14.DOWN.05 <- d14.DOWN.05[order(d14.DOWN.05$ontology, d14.DOWN.05$over_represented_pvalue, -d14.DOWN.05$numDEInCat),]
d14.DOWN.05$term <- as.factor(d14.DOWN.05$term)
d14.DOWN.05_filtered <- d14.DOWN.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d14.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 146
nrow(filter(d14.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 53
nrow(d14.DOWN.05_filtered) # == 228
# Day21 Primary Treatment effect
# UPREGULATED GENES - those with higher expression from ambient (control) stress priming
d21.UP.05<-GO_d21.UP$category[GO_d21.UP$over_represented_pvalue<.05]
d21.UP.05<-data.frame(d21.UP.05)
colnames(d21.UP.05) <- c("category")
d21.UP.05 <- merge(d21.UP.05, GO_d21.UP, by="category")
d21.UP.05 <- d21.UP.05[order(d21.UP.05$ontology, d21.UP.05$over_represented_pvalue, -d21.UP.05$numDEInCat),]
d21.UP.05$term <- as.factor(d21.UP.05$term)
d21.UP.05_filtered <- d21.UP.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d21.UP.05_filtered, ontology=="BP")) #number sig BP terms == 65
nrow(filter(d21.UP.05_filtered, ontology=="MF")) #number sig MF terms == 37
nrow(d21.UP.05_filtered) # == 116
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
d21.DOWN.05<-GO_d21.DOWN$category[GO_d21.DOWN$over_represented_pvalue<.05]
d21.DOWN.05<-data.frame(d21.DOWN.05)
colnames(d21.DOWN.05) <- c("category")
d21.DOWN.05 <- merge(d21.DOWN.05, GO_d21.DOWN, by="category")
d21.DOWN.05 <- d21.DOWN.05[order(d21.DOWN.05$ontology, d21.DOWN.05$over_represented_pvalue, -d21.DOWN.05$numDEInCat),]
d21.DOWN.05$term <- as.factor(d21.DOWN.05$term)
d21.DOWN.05_filtered <- d21.DOWN.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(d21.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 39
nrow(filter(d21.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 16
nrow(d21.DOWN.05_filtered) # == 67
# ALL CONSTANT DEGS Primary Treatment effect
# UPREGULATED GENES - those with higher expression from ambient (control) stress priming
Const.UP.05<-GO_Constant.UP$category[GO_Constant.UP$over_represented_pvalue<.05]
Const.UP.05<-data.frame(Const.UP.05)
colnames(Const.UP.05) <- c("category")
Const.UP.05 <- merge(Const.UP.05, GO_Constant.UP, by="category")
Const.UP.05 <- Const.UP.05[order(Const.UP.05$ontology, Const.UP.05$over_represented_pvalue, -Const.UP.05$numDEInCat),]
Const.UP.05$term <- as.factor(Const.UP.05$term)
Const.UP.05_filtered <- Const.UP.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(Const.UP.05_filtered, ontology=="BP")) #number sig BP terms == 65
nrow(filter(Const.UP.05_filtered, ontology=="MF")) #number sig MF terms == 37
nrow(Const.UP.05_filtered) # == 104
#DOWNREGULATED GENES  - those with higher expression from moderate stress priming
Const.DOWN.05<-GO_Constant.DOWN$category[GO_Constant.DOWN$over_represented_pvalue<.05]
Const.DOWN.05<-data.frame(Const.DOWN.05)
colnames(Const.DOWN.05) <- c("category")
Const.DOWN.05 <- merge(Const.DOWN.05, GO_Constant.DOWN, by="category")
Const.DOWN.05 <- Const.DOWN.05[order(Const.DOWN.05$ontology, Const.DOWN.05$over_represented_pvalue, -Const.DOWN.05$numDEInCat),]
Const.DOWN.05$term <- as.factor(Const.DOWN.05$term)
Const.DOWN.05_filtered <- Const.DOWN.05 %>% filter(!(numDEInCat<2 & ontology == "BP"), !(numDEInCat<2 & ontology == "MF"))
nrow(filter(Const.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 39
nrow(filter(Const.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 16
nrow(Const.DOWN.05_filtered) # == 16
nrow(filter(d21.UP.05_filtered, ontology=="BP")) #number sig BP terms == 65
nrow(filter(d21.UP.05_filtered, ontology=="MF")) #number sig MF terms == 37
nrow(d21.UP.05_filtered) # == 116
nrow(filter(d21.DOWN.05_filtered, ontology=="BP")) #number sig BP terms == 39
nrow(filter(d21.DOWN.05_filtered, ontology=="MF")) #number sig MF terms == 16
nrow(d21.DOWN.05_filtered) # == 67
d21.DOWN.05_filtered
write.csv(d0.UP.05, file    = "../Output/GO/DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d0.DOWN.05, file  = "../Output/GO/DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
d0.UP.05_filtered
d0.UP.05
d0.DOWN.05
Const.DOWN.05_filtered
Const.UP.05_filtered
d21.UP.05_filtered
write.csv(d7.UP.05, file    = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_PrimEffect_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d7.DOWN.05, file  = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_PrimEffect_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d7.UP.05_second, file    = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_SecondEffect_AvM_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d7.DOWN.05_second, file  = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d7.UP.05_MA_AM, file    = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_GroupEffect_MAvAM_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d7.DOWN.05_MA_AM, file  = "../Output/GO/DESeq2_goseq/Day7/GO.05.Day7_GroupEffect_MAvAM_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d14.UP.05, file   = "../Output/GO/DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d14.DOWN.05, file = "../Output/GO/DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d21.UP.05, file   = "../Output/GO/DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(d21.DOWN.05, file = "../Output/GO/DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(Const.UP.05, file   = "../Output/GO/DESeq2_goseq/GO.05.ConstantDEGs_PrimEffect_Upregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
write.csv(Const.DOWN.05, file = "../Output/GO/DESeq2_goseq/GO.05.ConstantDEGs_PrimEffect_Downregulated_unfiltered.csv", row.names = FALSE) # unfiltered of GO terms <= 2 numDEinCAT
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv")
---
# title: "compileGO_Master"
# author: "Samuel Gurr"
# date: "Sept 1, 2021"
---
# Purpose: :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# (1) UNFILTERED GO term data - WGCNA modules only
# The objective of this script is to complile all of the enriched gene ontology terms in significant WGCNa modules into one master
# cumulative csv file. This file will be used as the supplementary material for our manuscript - data in our manuscript contained a
# filtering step in which only BP terms with >=10 genes and only MF terms with >= 2 genes were used for goslim analysis
# PRODUCT: All_GOterms_unfiltered_Master.csv
# (2) UNFILTERED GO term data - DESEq2 results only
# The objective of this script is to complile all of the enriched gene ontology terms in significant WGCNa modules into one master
# cumulative csv file. This file will be used as the supplementary material for our manuscript - data in our manuscript contained a
# filtering step in which only BP terms with >=10 genes and only MF terms with >= 2 genes were used for goslim analysis
# PRODUCT: All_GOterms_unfiltered_Master.csv
# (3) GOSlim data - WGCNA modules only
# The next part of this script is to compile all of the GOslim results from the FILTERED GO enrichment analysis (NOT the unfiltered in #1)
# PRODUCT: All_GOSlim_Master.csv
# SET WORKING DIRECTORY   ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::;: #
setwd("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/GO/WGCNA_goseq/")
library(dplyr)
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv")
d0_PrimEff_downreg
d7_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day7/GO.05.Day7_PrimEffect_Downregulated_unfiltered.csv")
d7_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day7/GO.05.Day7_PrimEffect_Upregulated_unfiltered.csv")
d14_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Downregulated_unfiltered.csv")
d14_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Upregulated_unfiltered.csv")
d21_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Downregulated_unfiltered.csv")
d21_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Upregulated_unfiltered.csv")
d14_PrimEff_downreg
d7_SecondEffect_AvM_downreg   <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv")
d7_SecondEffect_AvM_downreg   <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv")
d7_SecondEffect_AvM_upreg     <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Upregulated_unfiltered.csv")
d7_GroupEffect_MAvAM_downreg      <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Downregulated_unfiltered.csv")
d7_GroupEffect_MAvAM_upreg        <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Upregulated_unfiltered.csv")
d0_PrimEff_downreg
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_PrimaryEffect')
d0_PrimEff_downreg
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated')
d0_PrimEff_downreg
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter!(ontology %in% 'CC')
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d0_PrimEff_downreg
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d0_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated') %>% dplyr::filter(!ontology %in% 'CC')
d7_PrimEff_downreg <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d7_PrimEff_upreg   <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')  %>% dplyr::filter(!ontology %in% 'CC')
d7_SecondEffect_AvM_downreg   <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d7_SecondEffect_AvM_upreg     <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC')
d7_GroupEffect_MAvAM_downreg      <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d7_GroupEffect_MAvAM_upreg        <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC')
d14_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d14_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC')
d21_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC')
d21_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC')
d14_PrimEff_downreg
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d0_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated') %>% dplyr::filter(!ontology %in% 'CC')  %>% arrange(ontology, desc(numDEInCat))
d7_PrimEff_downreg <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d7_PrimEff_upreg   <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')  %>% dplyr::filter(!ontology %in% 'CC')  %>% arrange(ontology, desc(numDEInCat))
d7_SecondEffect_AvM_downreg   <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d7_SecondEffect_AvM_upreg     <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d7_GroupEffect_MAvAM_downreg      <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d7_GroupEffect_MAvAM_upreg        <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d14_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d14_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d21_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
d21_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% 'CC') %>% arrange(ontology, desc(numDEInCat))
_
# compile master file
GO_Master_DESeq2 <- rbind(d0_PrimEff_downreg, d0_PrimEff_upreg,
d7_PrimEff_downreg, d7_PrimEff_upreg,
d7_SecondEffect_AvM_downreg, d7_SecondEffect_AvM_upreg,
d7_GroupEffect_MAvAM_downreg, d7_GroupEffect_MAvAM_upreg,
d14_PrimEff_downreg, d14_PrimEff_upreg,
d21_PrimEff_downreg, d21_PrimEff_upreg)
GO_Master_DESeq2
View(GO_Master_DESeq2)
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', '') %>% arrange(ontology, desc(numDEInCat))
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', '')) %>% arrange(ontology, desc(numDEInCat))
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d0_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Downregulated_unfiltered.csv") %>% dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d0_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day0/GO.05.Day0_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day0_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA'))  %>% arrange(ontology, desc(numDEInCat))
d7_PrimEff_downreg <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d7_PrimEff_upreg   <- read.csv("../DESeq2_goseq/Day7/primary_effect/GO.05.Day7_PrimEffect_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')  %>% dplyr::filter(!ontology %in% c('CC', 'NA'))  %>% arrange(ontology, desc(numDEInCat))
d7_SecondEffect_AvM_downreg   <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d7_SecondEffect_AvM_upreg     <- read.csv("../DESeq2_goseq/Day7/second_effect_AvM/GO.05.Day7_SecondEffect_AvM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Second_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d7_GroupEffect_MAvAM_downreg      <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d7_GroupEffect_MAvAM_upreg        <- read.csv("../DESeq2_goseq/Day7/group_effect_MAvAM/GO.05.Day7_GroupEffect_MAvAM_Upregulated_unfiltered.csv")   %>%  dplyr::mutate(Day_effect = 'Day7_Group_MAvAM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d14_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d14_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day14/GO.05.Day14_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day14_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d21_PrimEff_downreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Downregulated_unfiltered.csv") %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Downregulated') %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
d21_PrimEff_upreg  <- read.csv("../DESeq2_goseq/Day21/GO.05.Day21_PrimEffect_Upregulated_unfiltered.csv")     %>%  dplyr::mutate(Day_effect = 'Day21_Primary_AvM') %>% dplyr::mutate(Dir = 'Upregulated')   %>% dplyr::filter(!ontology %in% c('CC', 'NA')) %>% arrange(ontology, desc(numDEInCat))
# compile master file
GO_Master_DESeq2 <- rbind(d0_PrimEff_downreg, d0_PrimEff_upreg,
d7_PrimEff_downreg, d7_PrimEff_upreg,
d7_SecondEffect_AvM_downreg, d7_SecondEffect_AvM_upreg,
d7_GroupEffect_MAvAM_downreg, d7_GroupEffect_MAvAM_upreg,
d14_PrimEff_downreg, d14_PrimEff_upreg,
d21_PrimEff_downreg, d21_PrimEff_upreg)
View(GO_Master_DESeq2)
write.csv(GO_Master_DESeq2, file = paste("../DESeq2_goseq/DESEq2_GOterms_unfiltered_Master.csv", sep ='')) # write the file
