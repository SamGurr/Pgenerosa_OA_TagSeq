path_out
path_out = 'C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/'
path_out='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/'
write.table(GW.d0.primary.UPREG.om, paste(path_out,"/Genewalk_files/Day0.upreg_genewalk.csv"))
write.table(GW.d0.primary.UPREG.om, paste(path_out,"/Genewalk_files/Day0.upreg_genewalk"))
write.table(GW.d0.primary.UPREG.om, paste(path_out,"/Genewalk_files/Day0.upreg_genewalk.csv"), sep=",",  col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"/ Genewalk_files/Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out," Genewalk_files/Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Genewalk_files/Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Genewalk_files /Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Genewalk_files/ Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files'
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_out,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files'
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"/Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/'
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"/Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/'
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0.downreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7.downreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d14.primary.UPREG.om, paste(path_genewalk,"Day14.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d14.primary.DWNREG.om, paste(path_genewalk,"Day14.downreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d21.primary.UPREG.om, paste(path_genewalk,"Day21.upreg_genewalk.csv"), sep=",", col.names=FALSE)
write.table(GW.d21.primary.DWNREG.om, paste(path_genewalk,"Day21.downreg_genewalk.csv"), sep=",", col.names=FALSE)
GW.d21.primary.UPREG.om
GW.d0.primary.UPREG
GW.d0.primary.UPREG[2]
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG[1])
GW.d0.primary.UPREG.om
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- as.table(na.omit(GW.d0.primary.UPREG))
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- data.frame(na.omit(GW.d0.primary.UPREG))
GW.d0.primary.UPREG.om
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- list(na.omit(GW.d0.primary.UPREG))
GW.d0.primary.UPREG.om
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE)
na.omit(GW.d0.primary.UPREG)
list(GW.d0.primary.UPREG.om)
print(GW.d0.primary.UPREG.om, row.names = FALSE)
print((na.omit(GW.d0.primary.UPREG)), row.names = FALSE)
print(GW.d0.primary.UPREG.om, row.names = FALSE)
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0.upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0.downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7.upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7.downreg_genewalk.csv"), sep=",", col.names=FALSE, row.names=FALSE)
write.table(GW.d14.primary.UPREG.om, paste(path_genewalk,"Day14.upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d14.primary.DWNREG.om, paste(path_genewalk,"Day14.downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.UPREG.om, paste(path_genewalk,"Day21.upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.DWNREG.om, paste(path_genewalk,"Day21.downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V5")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
#Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0_upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0_downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7_upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7_downreg_genewalk.csv"), sep=",", col.names=FALSE, row.names=FALSE)
write.table(GW.d14.primary.UPREG.om, paste(path_genewalk,"Day14_upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d14.primary.DWNREG.om, paste(path_genewalk,"Day14_downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.UPREG.om, paste(path_genewalk,"Day21_upreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.DWNREG.om, paste(path_genewalk,"Day21_downreg_genewalk.csv"), sep=",", col.names=FALSE,row.names=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC_symbol") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7_downreg.csv"), sep=",", col.names=FALSE, row.names=FALSE)
write.table(GW.d14.primary.UPREG.om, paste(path_genewalk,"Day14_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d14.primary.DWNREG.om, paste(path_genewalk,"Day14_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.UPREG.om, paste(path_genewalk,"Day21_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.DWNREG.om, paste(path_genewalk,"Day21_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC_symbol") # rename columns
Geoduck.gene_HGNC.list
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC_symbol") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.UPREG.om, paste(path_genewalk,"Day7_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d7.primary.DWNREG.om, paste(path_genewalk,"Day7_downreg.csv"), sep=",", col.names=FALSE, row.names=FALSE)
write.table(GW.d14.primary.UPREG.om, paste(path_genewalk,"Day14_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d14.primary.DWNREG.om, paste(path_genewalk,"Day14_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.UPREG.om, paste(path_genewalk,"Day21_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
write.table(GW.d21.primary.DWNREG.om, paste(path_genewalk,"Day21_downreg.csv"), sep=",", col.names=FALSE,row.names=FALSE)
GW.d7.primary.UPREG.om
# output files
write.table(GW.d0.primary.UPREG.om, paste(path_genewalk,"Day0_upreg.csv"), sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC_symbol") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om,paste(path_genewalk,"Day0_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d7.primary.UPREG.om,paste(path_genewalk,"Day7_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d7.primary.DWNREG.om,paste(path_genewalk,"Day7_downreg.csv"),sep=",", col.names=FALSE, row.names=FALSE, quote=FALSE)
write.table(GW.d14.primary.UPREG.om,paste(path_genewalk,"Day14_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d14.primary.DWNREG.om,paste(path_genewalk,"Day14_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d21.primary.UPREG.om,paste(path_genewalk,"Day21_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d21.primary.DWNREG.om,paste(path_genewalk,"Day21_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
GW_summarytable <- data.frame(matrix(nrow = 4, ncol = 8)) # create a new data table
colnames(GW_summarytable)<-c('Day', 'Treatment', 'DEGs_upreg', 'numHGNC_upreg', 'percHGNC_upreg', 'DEGs_dwnreg', 'numHGNC_dwnreg', 'percHGNC_dwnreg')
GW_summarytable$Day <- c("0","7","14","21")
GW_summarytable$Treatment <- "Ambient_v_Moderate"
GW_summarytable$DEGs_upreg <- c((dim(DE_d0.primary.UPREG)[1]), (dim(DE_d7.primary.UPREG)[1]), (dim(DE_d14.primary.UPREG)[1]), (dim(DE_d21.primary.UPREG)[1]))
GW_summarytable$numHGNC_upreg <- c((dim(na.omit(GW.d0.primary.UPREG))[1]),(dim(na.omit(GW.d7.primary.UPREG))[1]),(dim(na.omit(GW.d14.primary.UPREG))[1]),(dim(na.omit(GW.d21.primary.UPREG))[1]))
GW_summarytable$percHGNC_upreg <- c(d0.upreg.percHGNC,d7.upreg.percHGNC,d14.upreg.percHGNC,d21.upreg.percHGNC)
GW_summarytable$DEGs_dwnreg <- c((dim(DE_d0.primary.DWNREG)[1]), (dim(DE_d7.primary.DWNREG)[1]), (dim(DE_d14.primary.DWNREG)[1]), (dim(DE_d21.primary.DWNREG)[1]))
GW_summarytable$numHGNC_dwnreg<- c((dim(na.omit(GW.d0.primary.DWNREG))[1]),(dim(na.omit(GW.d7.primary.DWNREG))[1]),(dim(na.omit(GW.d14.primary.DWNREG))[1]),(dim(na.omit(GW.d21.primary.DWNREG))[1]))
GW_summarytable$percHGNC_dwnreg <- c(d0.downreg.percHGNC,d7.downreg.percHGNC,d14.downreg.percHGNC,d21.downreg.percHGNC)
knitr::kable(GW_summarytable, caption = "Summary table of Genewalk files - total DEGs and mapping abund HGNC IDs")
# Objective here is to call the DE genes (up and down)
# DAY 0 ------------------------------------------- #
dim(DE_d0.primary) # day0 - should be 13
DE_d0.primary.UPREG  <- DE_d0.primary %>% dplyr::filter(up %in% TRUE)               # UPREG call
DE_d0.primary.DWNREG <- DE_d0.primary %>% dplyr::filter(down %in% TRUE)             # DWNREG call
# DAY 7 ------------------------------------------- #
dim(DE_d7.primary) # day7 - should be 111
DE_d7.primary.UPREG  <- DE_d7.primary %>% dplyr::filter(up %in% TRUE)               # UPREG call
DE_d7.primary.DWNREG <- DE_d7.primary %>% dplyr::filter(down %in% TRUE)             # DWNREG call
# DAY 14 ------------------------------------------- #
dim(DE_d14.primary) # day14 - should be 511
DE_d14.primary.UPREG  <- DE_d14.primary %>% dplyr::filter(up %in% TRUE)             # UPREG call
DE_d14.primary.DWNREG <- DE_d21.primary %>% dplyr::filter(down %in% TRUE)           # DWNREG call
# DAY 21 ------------------------------------------- #
dim(DE_d21.primary) # day21 - should be 233
DE_d21.primary.UPREG  <- DE_d21.primary %>% dplyr::filter(up %in% TRUE)             # UPREG call
DE_d21.primary.DWNREG <- DE_d21.primary %>% dplyr::filter(down %in% TRUE)           # DWNREG call
Geoduck.gene_HGNC.list <- Geoduck_annotation %>% select(c("V1","V6")) # call the geoduck gene ID and the HGNC in the annotation file
colnames(Geoduck.gene_HGNC.list) <- c("gene.ID", "HGNC_symbol") # rename columns
# note that the HGNC column contains the HNC code with the model taxa as 'HUMAN, MOUSE, CHICK, etc.'
Geoduck.gene_HGNC.list$HGNC<- sapply(strsplit((Geoduck.gene_HGNC.list$HGNC), "_"), '[', 1) # this splits the HGNC by the delimiter "_" and calls just the HGNC code - note the model taxa is now absent from the dataframe!
# change the col name of the gene.ID  in the DE datasets
# DAY 0 ------------------------------------------- #
# UPREGULATED
colnames(DE_d0.primary.UPREG)[2] <- "gene.ID"
GW.d0.primary.UPREG <- merge((DE_d0.primary.UPREG[order(DE_d0.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.upreg.percHGNC <- ((dim(na.omit(GW.d0.primary.UPREG))[1]) / (dim(DE_d0.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d0.primary.DWNREG)[2] <- "gene.ID"
GW.d0.primary.DWNREG <- merge((DE_d0.primary.DWNREG[order(DE_d0.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d0.downreg.percHGNC <- ((dim(na.omit(GW.d0.primary.DWNREG))[1]) / (dim(DE_d0.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 7 ------------------------------------------- #
# UPREGULATED
colnames(DE_d7.primary.UPREG)[2] <- "gene.ID"
GW.d7.primary.UPREG <- merge((DE_d7.primary.UPREG[order(DE_d7.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.upreg.percHGNC <- ((dim(na.omit(GW.d7.primary.UPREG))[1]) / (dim(DE_d7.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d7.primary.DWNREG)[2] <- "gene.ID"
GW.d7.primary.DWNREG <- merge((DE_d7.primary.DWNREG[order(DE_d7.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d7.downreg.percHGNC <- ((dim(na.omit(GW.d7.primary.DWNREG))[1]) / (dim(DE_d7.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 14 ------------------------------------------- #
# UPREGULATED
colnames(DE_d14.primary.UPREG)[2] <- "gene.ID"
GW.d14.primary.UPREG <- merge((DE_d14.primary.UPREG[order(DE_d14.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d14.upreg.percHGNC <- ((dim(na.omit(GW.d14.primary.UPREG))[1]) / (dim(DE_d14.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d14.primary.DWNREG)[2] <- "gene.ID"
GW.d14.primary.DWNREG <- merge((DE_d14.primary.DWNREG[order(DE_d14.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC") # sort to order by greatest logfold change and merge with HGNC list
d14.downreg.percHGNC <- ((dim(na.omit(GW.d14.primary.DWNREG))[1]) / (dim(DE_d14.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
# DAY 21 ------------------------------------------- #
# UPREGULATED
colnames(DE_d21.primary.UPREG)[2] <- "gene.ID"
GW.d21.primary.UPREG <- merge((DE_d21.primary.UPREG[order(DE_d21.primary.UPREG$log2FoldChange, decreasing = TRUE),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.upreg.percHGNC <- ((dim(na.omit(GW.d21.primary.UPREG))[1]) / (dim(DE_d21.primary.UPREG)[1]) )*100 # percent of DEGs with HGNC ID
# DOWNREGULATED
colnames(DE_d21.primary.DWNREG)[2] <- "gene.ID"
GW.d21.primary.DWNREG <- merge((DE_d21.primary.DWNREG[order(DE_d21.primary.DWNREG$log2FoldChange),]), Geoduck.gene_HGNC.list, by = "gene.ID") %>% dplyr::select("HGNC")
d21.downreg.percHGNC <- ((dim(na.omit(GW.d21.primary.DWNREG))[1]) / (dim(DE_d21.primary.DWNREG)[1]) )*100 # percent of DEGs with HGNC ID
### OUTPUT Genewalk tables as csv wihtout header
GW.d0.primary.UPREG.om   <- na.omit(GW.d0.primary.UPREG)
GW.d0.primary.DWNREG.om  <- na.omit(GW.d0.primary.DWNREG)
GW.d7.primary.UPREG.om   <- na.omit(GW.d7.primary.UPREG)
GW.d7.primary.DWNREG.om  <- na.omit(GW.d7.primary.DWNREG)
GW.d14.primary.UPREG.om  <- na.omit(GW.d14.primary.UPREG)
GW.d14.primary.DWNREG.om <- na.omit(GW.d14.primary.DWNREG)
GW.d21.primary.UPREG.om  <- na.omit(GW.d21.primary.UPREG)
GW.d21.primary.DWNREG.om <- na.omit(GW.d21.primary.DWNREG)
path_genewalk='C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/RAnalysis/GO/Genewalk_files/' # call path
# output files
write.table(GW.d0.primary.UPREG.om,paste(path_genewalk,"Day0_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d0.primary.DWNREG.om, paste(path_genewalk,"Day0_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d7.primary.UPREG.om,paste(path_genewalk,"Day7_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d7.primary.DWNREG.om,paste(path_genewalk,"Day7_downreg.csv"),sep=",", col.names=FALSE, row.names=FALSE, quote=FALSE)
write.table(GW.d14.primary.UPREG.om,paste(path_genewalk,"Day14_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d14.primary.DWNREG.om,paste(path_genewalk,"Day14_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d21.primary.UPREG.om,paste(path_genewalk,"Day21_upreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
write.table(GW.d21.primary.DWNREG.om,paste(path_genewalk,"Day21_downreg.csv"),sep=",", col.names=FALSE,row.names=FALSE, quote=FALSE)
GW_summarytable <- data.frame(matrix(nrow = 4, ncol = 8)) # create a new data table
colnames(GW_summarytable)<-c('Day', 'Treatment', 'DEGs_upreg', 'numHGNC_upreg', 'percHGNC_upreg', 'DEGs_dwnreg', 'numHGNC_dwnreg', 'percHGNC_dwnreg')
GW_summarytable$Day <- c("0","7","14","21")
GW_summarytable$Treatment <- "Ambient_v_Moderate"
GW_summarytable$DEGs_upreg <- c((dim(DE_d0.primary.UPREG)[1]), (dim(DE_d7.primary.UPREG)[1]), (dim(DE_d14.primary.UPREG)[1]), (dim(DE_d21.primary.UPREG)[1]))
GW_summarytable$numHGNC_upreg <- c((dim(na.omit(GW.d0.primary.UPREG))[1]),(dim(na.omit(GW.d7.primary.UPREG))[1]),(dim(na.omit(GW.d14.primary.UPREG))[1]),(dim(na.omit(GW.d21.primary.UPREG))[1]))
GW_summarytable$percHGNC_upreg <- c(d0.upreg.percHGNC,d7.upreg.percHGNC,d14.upreg.percHGNC,d21.upreg.percHGNC)
GW_summarytable$DEGs_dwnreg <- c((dim(DE_d0.primary.DWNREG)[1]), (dim(DE_d7.primary.DWNREG)[1]), (dim(DE_d14.primary.DWNREG)[1]), (dim(DE_d21.primary.DWNREG)[1]))
GW_summarytable$numHGNC_dwnreg<- c((dim(na.omit(GW.d0.primary.DWNREG))[1]),(dim(na.omit(GW.d7.primary.DWNREG))[1]),(dim(na.omit(GW.d14.primary.DWNREG))[1]),(dim(na.omit(GW.d21.primary.DWNREG))[1]))
GW_summarytable$percHGNC_dwnreg <- c(d0.downreg.percHGNC,d7.downreg.percHGNC,d14.downreg.percHGNC,d21.downreg.percHGNC)
knitr::kable(GW_summarytable, caption = "Summary table of Genewalk files - total DEGs and mapping abund HGNC IDs")
