d21.DOWN_BPslim <- mappedIds(d21.DOWN_slims_bp, d21.DOWN_BP_GO_collection, GOBPOFFSPRING)
d21.DOWN_MFslim <- mappedIds(d21.DOWN_slims_mf, d21.DOWN_MF_GO_collection, GOMFOFFSPRING)
# all
All.UP_BPslim <- mappedIds(All.UP_slims_bp, All.UP_BP_GO_collection, GOBPOFFSPRING)
All.UP_MFslim <- mappedIds(All.UP_slims_mf, All.UP_MF_GO_collection, GOMFOFFSPRING)
All.DOWN_BPslim <- mappedIds(All.DOWN_slims_bp, All.DOWN_BP_GO_collection, GOBPOFFSPRING)
All.DOWN_MFslim <- mappedIds(All.DOWN_slims_mf, All.DOWN_MF_GO_collection, GOMFOFFSPRING)
# Build a master list of all genes and GO terms
Geoduck_annotation <- read.delim2(file="C:/Users/samjg/Documents/My_Projects/Pgenerosa_TagSeq_Metabolomics/TagSeq/Seq_details/Panopea-generosa-genes-annotations.txt", header=F) # Load themaster Pgenerosa gene list
Pgen_GOterms <- Geoduck_annotation %>% dplyr::select(c('V1','V8')) # select only two columns - those with the gene IDs and those with the GO terms
Pgen_GOterms2 <- strsplit(Pgen_GOterms$V8, split = "; ") # create a string splitting by delimiter '; ' - view the data to see that this separates each GO term entry in the string
Pgen_GOterms2 <- data.frame(gene.ID = rep(Pgen_GOterms$V1, sapply(Pgen_GOterms2, length)), Go.terms = unlist(Pgen_GOterms2)) # create new dataframe 'Pgen_GOterms2' listing genes for each GO term (MUCH longer!)
Pgen_GOterms2 <- na.omit(Pgen_GOterms2) # ommit the NAs  - genes without GO annotation
Pgen_GOterms_ALL_UPREG <- Pgen_GOterms2 %>%  dplyr::filter(gene.ID %in% All.primary.UPREG$Row.names) # 'All.primary.UPREG' lists all upregualted genes Days 0, 7, 14, 21 in response to primary treatment
dplyr::filter(numDEInCat > 0)
GO_Constant.UP_summary <- GO_Constant.UP %>% dplyr::select(c('category','numDEInCat','numInCat', 'term', 'ontology')) %>% dplyr::filter(!is.na(term)) %>% dplyr::filter(numDEInCat > 0)
GO_d7.UP.05.a<-GO_d7.UP$category[GO_d7.UP$over_represented_pvalue<.05] # change twice here
# call enriched GO terms and plot
#  UPREGULATED GENES!
# day 7 UPREGULATED
GO_d7.UP.05.a<-GO_d7.UP$category[d7.UP.05$over_represented_pvalue<.05] # change twice here
# call enriched GO terms and plot
#  UPREGULATED GENES!
# day 7 UPREGULATED
GO_d7.UP.05.a<-d7.UP.05$category[d7.UP.05$over_represented_pvalue<.05] # change twice here
GO_d7.UP.05<-data.frame(GO_d7.UP.05.a)
colnames(GO_d7.UP.05) <- c("category")
GO_d7.UP.05 <- merge(GO_d7.UP.05, GO_d7.UP, by="category") # change here
GO_d7.UP.05 <- merge(GO_d7.UP.05, d7.UP.05, by="category") # change here
GO_d7.UP.05 <- GO_d7.UP.05[order(-GO_d7.UP.05$numDEInCat),]
GO_d7.UP.05$term <- as.factor(GO_d7.UP.05$term)
GO_d7.UP.05
d7_UP_MF <- GO_d7.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd7_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d7_UP'))
d7_UP_MF
d7_UP_BP <- GO_d7.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd7_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d7_UP'))
GO_d14.UP.05.a<-d14.UP.05$category[GO_d14.UP$over_represented_pvalue<.05] # change twice here
# day 14 UPREGULATED
GO_d14.UP.05.a<-d14.UP.05$category[d14.UP.05$over_represented_pvalue<.05] # change twice here
GO_d14.UP.05<-data.frame(GO_d14.UP.05.a)
colnames(GO_d14.UP.05) <- c("category")
GO_d14.UP.05 <- merge(GO_d14.UP.05, d14.UP.05, by="category") # change here
GO_d14.UP.05 <- GO_d14.UP.05[order(-GO_d14.UP.05$numDEInCat),]
GO_d14.UP.05$term <- as.factor(GO_d14.UP.05$term)
d14_UP_MF <- GO_d14.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd14_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d14_UP'))
d14_UP_BP <- GO_d14.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd14_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d14_UP'))
GO_d21.UP.05.a<-d21.UP.05$category[d21.UP.05$over_represented_pvalue<.05] # change twice here
GO_d21.UP.05<-data.frame(GO_d21.UP.05.a)
colnames(GO_d21.UP.05) <- c("category")
GO_d21.UP.05 <- merge(GO_d21.UP.05, d21.UP.05, by="category") # change here
GO_d21.UP.05 <- GO_d21.UP.05[order(-GO_d21.UP.05$numDEInCat),]
GO_d21.UP.05$term <- as.factor(GO_d21.UP.05$term)
d21_UP_MF <- GO_d21.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd21_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d21_UP'))
d21_UP_BP <- GO_d21.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd21_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d21_UP'))
#======================================================================= #
# bind the rows of MF and BP in the clustered modules (those twith primary treatment effect in same pattern/directionality)
MF_UP <- rbind(d7_UP_MF, d14_UP_MF, d21_UP_MF)
BP_UP <- rbind(d7_UP_BP, d14_UP_BP, d21_UP_BP)
MF_UP_plot  <- MF_UP %>%
mutate(term = fct_reorder(term, ontology)) %>%
ggplot(aes(factor(ontology,level = c('MF_d7_UP', 'MF_d14_UP', 'MF_d21_UP')), term, fill= factor(ontology), alpha = over_represented_pvalue)) +
geom_tile(fill = '#00BFC4') +
scale_alpha_continuous(range = c(1, 0.3)) +
theme_classic2() +
ggtitle("GO Mol Fxn: Priming effect (> Exp in AMBIENT history)") +
xlab("GO.ontology_Sampling.Day") +
ylab('') +
theme(legend.position="none")
BP_UP_plot <- BP_UP %>%
mutate(term = fct_reorder(term, ontology)) %>%
ggplot(aes(factor(ontology,level = c('BP_d7_UP', 'BP_d14_UP', 'BP_d21_UP')), term, fill= factor(ontology), alpha = over_represented_pvalue)) +
geom_tile(fill = '#F8766D') +
scale_alpha_continuous(range = c(1, 0.3)) +
theme_classic2() +
ggtitle("GO Biol Proc: Priming effect (> Exp in AMBIENT history)") +
xlab("GO.ontology_Sampling.Day") +
ylab('') +
theme(legend.position="none")
MF_UP_plot
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_UP_plot, BP_UP_plot,
plotlist = NULL,
ncol = 2,
nrow = 1,
labels = NULL))
dev.off()
BP_UP_plot
MF_UP_plot
MF_UP
MF_UP %>% ggplot(data = BP_All_filtered, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
MF_UP %>% ggplot(data = MF_UP, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
ggplot(data = MF_UP, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 2,
nrow = 1,
labels = NULL))
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 2,
nrow = 1,
labels = NULL))
dev.off()
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
MF_UP_plot <- ggplot(data = MF_UP, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=10, height=10)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=20, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
MF_UP_plot <- ggplot(data = MF_UP, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=20, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
MF_UP
MF_UP_plot <- MF_UP %>%  dplyr::filter(!numDEInCat <10) %>%
ggplot(data = MF_UP, aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
MF_UP %>%  dplyr::filter(!numDEInCat<10)
MF_UP_plot <- MF_UP %>%  dplyr::filter(!numDEInCat<10) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=20, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
MF_UP_plot <- MF_UP %>%  dplyr::filter(!numDEInCat<5) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=20, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=10, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
GO_d0.UP.05.a<-d0.UP.05$category[d0.UP.05$over_represented_pvalue<.05] # change twice here
GO_d0.UP.05<-data.frame(GO_d0.UP.05.a)
colnames(GO_d0.UP.05) <- c("category")
GO_d0.UP.05 <- merge(GO_d0.UP.05, d0.UP.05, by="category") # change here
GO_d0.UP.05 <- GO_d0.UP.05[order(-GO_d0.UP.05$numDEInCat),]
GO_d0.UP.05$term <- as.factor(GO_d0.UP.05$term)
d0_UP_MF <- GO_d0.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd0_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d0_UP'))
d0_UP_BP <- GO_d0.UP.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd0_UP', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d0_UP'))
#======================================================================= #
# bind the rows of MF and BP in the clustered modules (those twith primary treatment effect in same pattern/directionality)
MF_UP <- rbind(d0_UP_MF, d7_UP_MF, d14_UP_MF, d21_UP_MF)
BP_UP <- rbind(d0_UP_BP, d7_UP_BP, d14_UP_BP, d21_UP_BP)
MF_UP_plot <- MF_UP %>%  dplyr::filter(!numDEInCat<5) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biological Process: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Upregulated.pdf", sep =''), width=10, height=8)
print(ggarrange(MF_UP_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
BP_UP_plot <- BP_UP %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Molecular Function: DESeq2 DEGs PrimEffect')
BP_UP_plot
GO_d0.DOWN.05.a<-d0.DOWN.05$category[d0.DOWN.05$over_represented_pvalue<.05] # change twice here
GO_d0.DOWN.05<-data.frame(GO_d0.DOWN.05.a)
colnames(GO_d0.DOWN.05) <- c("category")
GO_d0.DOWN.05 <- merge(GO_d0.DOWN.05, d0.DOWN.05, by="category") # change here
GO_d0.DOWN.05 <- GO_d0.DOWN.05[order(-GO_d0.DOWN.05$numDEInCat),]
GO_d0.DOWN.05$term <- as.factor(GO_d0.DOWN.05$term)
d0_DOWN_MF <- GO_d0.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd0_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d0_DOWN'))
d0_DOWN_BP <- GO_d0.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd0_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d0_DOWN'))
# day 7 DOWNREGULATED
GO_d7.DOWN.05.a<-d7.DOWN.05$category[d7.DOWN.05$over_represented_pvalue<.05] # change twice here
GO_d7.DOWN.05<-data.frame(GO_d7.DOWN.05.a)
colnames(GO_d7.DOWN.05) <- c("category")
GO_d7.DOWN.05 <- merge(GO_d7.DOWN.05, d7.DOWN.05, by="category") # change here
GO_d7.DOWN.05 <- GO_d7.DOWN.05[order(-GO_d7.DOWN.05$numDEInCat),]
GO_d7.DOWN.05$term <- as.factor(GO_d7.DOWN.05$term)
d7_DOWN_MF <- GO_d7.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd7_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d7_DOWN'))
d7_DOWN_BP <- GO_d7.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd7_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d7_DOWN'))
# day 14 DOWNREGULATED
GO_d14.DOWN.05.a<-d14.DOWN.05$category[d14.DOWN.05$over_represented_pvalue<.05] # change twice here
GO_d14.DOWN.05<-data.frame(GO_d14.DOWN.05.a)
colnames(GO_d14.DOWN.05) <- c("category")
GO_d14.DOWN.05 <- merge(GO_d14.DOWN.05, d14.DOWN.05, by="category") # change here
GO_d14.DOWN.05 <- GO_d14.DOWN.05[order(-GO_d14.DOWN.05$numDEInCat),]
GO_d14.DOWN.05$term <- as.factor(GO_d14.DOWN.05$term)
d14_DOWN_MF <- GO_d14.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd14_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d14_DOWN'))
d14_DOWN_BP <- GO_d14.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd14_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d14_DOWN'))
# day 21 DOWNREGULATED
GO_d21.DOWN.05.a<-d21.DOWN.05$category[d21.DOWN.05$over_represented_pvalue<.05] # change twice here
GO_d21.DOWN.05<-data.frame(GO_d21.DOWN.05.a)
colnames(GO_d21.DOWN.05) <- c("category")
GO_d21.DOWN.05 <- merge(GO_d21.DOWN.05, d21.DOWN.05, by="category") # change here
GO_d21.DOWN.05 <- GO_d21.DOWN.05[order(-GO_d21.DOWN.05$numDEInCat),]
GO_d21.DOWN.05$term <- as.factor(GO_d21.DOWN.05$term)
d21_DOWN_MF <- GO_d21.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd21_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('MF_d21_DOWN'))
d21_DOWN_BP <- GO_d21.DOWN.05 %>%
drop_na(ontology) %>%
mutate(term = fct_reorder(term, (-log10(over_represented_pvalue)) ),
ontology = paste(ontology, 'd21_DOWN', sep = "_")) %>%
dplyr::filter(ontology %in% ('BP_d21_DOWN'))
#======================================================================= #
# bind the rows of MF and BP in the clustered modules (those twith primary treatment effect in same pattern/directionality)
MF_DOWN <- rbind(d0_DOWN_MF, d7_DOWN_MF, d14_DOWN_MF, d21_DOWN_MF)
BP_DOWN <- rbind(d0_DOWN_BP, d7_DOWN_BP, d14_DOWN_BP, d21_DOWN_BP)
MF_DOWN_plot <- MF_UP %>%  dplyr::filter(!numDEInCat<5) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Molecular Function: DESeq2 DEGs PrimEffect')
MF_DOWN_plot <- MF_DOWN %>%  dplyr::filter(!numDEInCat<5) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Molecular Function: DESeq2 DEGs PrimEffect')
BP_DOWN_plot <- BP_DOWN %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Biol Proc: DESeq2 DEGs PrimEffect')
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Downregulated.pdf", sep =''), width=30, height=25)
print(ggarrange(MF_DOWN_plot, BP_DOWN_plot,
plotlist = NULL,
ncol = 2,
nrow = 1,
labels = NULL))
BP_DOWN_plot
MF_DOWN_plot
MF_DOWN_plot <- MF_DOWN %>%  dplyr::filter(!numDEInCat<2) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Molecular Function: DESeq2 DEGs PrimEffect')
MF_DOWN_plot
MF_DOWN_plot <- MF_DOWN %>%  dplyr::filter(!numDEInCat<3) %>%
ggplot(aes(x = Day, y = term)) +
geom_tile(aes(fill=numDEInCat, width = 1)) +
scale_fill_gradient(low = "thistle1", high = "steelblue4") +
facet_grid(~Dir, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GOslim Molecular Function: DESeq2 DEGs PrimEffect')
MF_DOWN_plot
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Downregulated.pdf", sep =''), width=10, height=8)
print(ggarrange(MF_DOWN_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
pdf(paste("../Output/GO/DESeq2_goseq/GOplot_DESeq2_PrimEffect_Downregulated.pdf", sep =''), width=25, height=8)
print(ggarrange(MF_DOWN_plot,
plotlist = NULL,
ncol = 1,
nrow = 1,
labels = NULL))
dev.off()
MF_DOWN
