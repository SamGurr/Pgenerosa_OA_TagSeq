res.ALL.TRMTS.contrasts <- results(dds.all.treatments, contrast=c("All_Treatment","AA","A")) # alternative way of calling the results (i.e. Day_DAY21_vs_Day0)
res.ALL.TRMTS_Ordered <- res.ALL.TRMTS[order(res.ALL.TRMTS$pvalue),] # how to order based on p-value; chosses EHSM vs A - the last pairwise call
res.ALL.TRMTS_Ordered # ordered based on pvalue
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=TRUE) # 1417 marginal DEGs
sum(res.ALL.TRMTS_Ordered$pvalue < 0.05, na.rm=TRUE) # 1071 significant DEGs
summary(res.ALL.TRMTS)
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.A.d0_AA.d7 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d7","A.d0"))
sum(res.A.d0_AA.d7$padj < 0.1, na.rm=TRUE) # 1 marginal DEGs
sum(res.A.d0_AA.d7$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.A.d0_AA.d7.DATAFRAME <- as.data.frame(res.A.d0_AA.d7)
res.A.d0_AA.d7.DEGS <- res.A.d0_AA.d7.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
View(res.A.d0_AA.d7.DEGS) # 1 total DEG
res.ALL.TRMTS_Ordered # ordered based on pvalue
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=TRUE) # 1417 marginal DEGs
sum(res.ALL.TRMTS_Ordered$pvalue < 0.05, na.rm=TRUE) # 1071 significant DEGs
res.ALL.TRMTS
# Note: these are all different ways of looking at the same results...
res.ALL.TRMTS <- results(dds.all.treatments) # view DESeq2 result - calls the last pairwise condition
resultsNames(dds.all.treatments) # view the names of your results model
res.ALL.TRMTS <- results(dds.all.treatments, name="All_Treatment_MSM.d21_vs_A.d0")
res.ALL.TRMTS.contrasts <- results(dds.all.treatments, contrast=c("All_Treatment","MSM.d21","A.d0")) # alternative way of calling the results (i.e. Day_DAY21_vs_Day0)
res.ALL.TRMTS_Ordered <- res.ALL.TRMTS[order(res.ALL.TRMTS$pvalue),] # how to order based on p-value; chosses EHSM vs A - the last pairwise call
res.ALL.TRMTS_Ordered # ordered based on pvalue
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=TRUE) # 1417 marginal DEGs
sum(res.ALL.TRMTS_Ordered$pvalue < 0.05, na.rm=TRUE) # 1071 significant DEGs
res.ALL.TRMTS
summary(res.ALL.TRMTS)
res.ALL.TRMTS_Ordered <- res.ALL.TRMTS[order(res.ALL.TRMTS$pvalue),] # how to order based on p-value; chosses EHSM vs A - the last pairwise call
res.ALL.TRMTS_Ordered # ordered based on pvalue
res.ALL.TRMTS <- results(dds.all.treatments, name="All_Treatment_MSM.d21_vs_A.d0")
res.ALL.TRMTS
sum(res.ALL.TRMTS$pvalue < 0.1, na.rm=TRUE) # 2165  DEGs between Day0 Amb and Day 21 MSM
summary(res.ALL.TRMTS)
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.A.d0_AA.d7 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d7","A.d0"))
sum(res.A.d0_AA.d7$padj < 0.1, na.rm=TRUE) # 1 marginal DEGs
sum(res.A.d0_AA.d7$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.A.d0_AA.d7.DATAFRAME <- as.data.frame(res.A.d0_AA.d7)
res.A.d0_AA.d7.DEGS <- res.A.d0_AA.d7.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
View(res.A.d0_AA.d7.DEGS) # 1 total DEG
# View(res.A.d0_AA.d7.DEGS) # 1 total DEG
summary(res.A.d0_AA.d7.DEGS)
# View(res.A.d0_AA.d7.DEGS) # 1 total DEG
summary(res.A.d0_AA.d7)
summary(res.ALL.TRMTS)
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=TRUE) # 2165  DEGs between Day0 Amb and Day 21 MSM
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=F) # 2165  DEGs between Day0 Amb and Day 21 MSM
sum(res.ALL.TRMTS_Ordered$pvalue < 0.1, na.rm=TRUE) # 2165  DEGs between Day0 Amb and Day 21 MSM
summary(res.ALL.TRMTS_Ordered)
res.ALL.TRMTS
summary(res.ALL.TRMTS)
# A.d0_AA.D14 # Ambient Controls Day 0 compared to Day 14
res.A.d0_AA.d14 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d14","A.d0"))
sum(res.A.d0_AA.d14$padj < 0.1, na.rm=TRUE) # 6 marginal DEGs
sum(res.A.d0_AA.d14$padj < 0.05, na.rm=TRUE) # 5 significant DEGs
res.A.d0_AA.d14.DATAFRAME <- as.data.frame(res.A.d0_AA.d14)
res.A.d0_AA.d14.DEGS <- res.A.d0_AA.d14.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
# View(res.A.d0_AA.d14.DEGS) # 5 total DEGs
# one of these, PGEN_.00g045760, is Fatty acid synthase
summary(res.A.d0_AA.d14)
# View(res.A.d0_AAA.d21.DEGS) # 20 total DEGs
summary(res.A.d0_AAA.d21)
# # A.d0_AAa.d21 # Ambient Controls Day 0 compared to Day 21
res.A.d0_AAA.d21 <- results(dds.all.treatments, contrast=c("All_Treatment","AAA.d21","A.d0"))
sum(res.A.d0_AAA.d21$padj < 0.1, na.rm=TRUE) # 67 marginal DEGs
sum(res.A.d0_AAA.d21$padj < 0.05, na.rm=TRUE) # 20 significant DEGs
res.A.d0_AAA.d21.DATAFRAME <- as.data.frame(res.A.d0_AAA.d21)
res.A.d0_AAA.d21.DEGS <- res.A.d0_AAA.d21.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
# View(res.A.d0_AAA.d21.DEGS) # 20 total DEGs
summary(res.A.d0_AAA.d21)
res.A.d0_AA.d7.DEGS
res.A.d0_AAA.d21
res.A.d0_AAA.d21.DATAFRAME
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME, res.A.d0_AA.d14.DATAFRAME, res.A.d0_AAA.d21.DATAFRAME), data.table)
install.packages("data.table")
library(data.frame)
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME, res.A.d0_AA.d14.DATAFRAME, res.A.d0_AAA.d21.DATAFRAME), data.table)
library(data.frame)
library(data.table)
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME, res.A.d0_AA.d14.DATAFRAME, res.A.d0_AAA.d21.DATAFRAME), data.table)
Amb.DEGs
res.A.d0_AA.d7.DATAFRAME
res.A.d0_AAA.d21.DATAFRAME <- as.data.frame(res.A.d0_AAA.d21)
res.A.d0_AAA.d21.DATAFRAME
# what we find are a total of 26 significantly differentially expressed genes (p < 0.05)
# lets call these in a dataset for fun using the package 'data.frame'
res.A.d0_AA.d7.DATAFRAME$Gene.ID <- row.names(res.A.d0_AA.d7.DATAFRAME) # change row names to a column 'Gene.ID'
res.A.d0_AA.d14.DATAFRAME$Gene.ID <- row.names(res.A.d0_AA.d14.DATAFRAME) # change row names to a column 'Gene.ID'
res.A.d0_AAA.d21.DATAFRAME$Gene.ID <- row.names(res.A.d0_AAA.d21.DATAFRAME) # change row names to a column'Gene.ID'
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME, res.A.d0_AA.d14.DATAFRAME, res.A.d0_AAA.d21.DATAFRAME), data.table)
Amb.DEGs.IDs.keep <-rbind(lapply(Amb.DEGs, '[', j = 'Gene.ID'))
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))
Amb.DEGs.IDs.keep
res.A.d0_AAA.d21.DATAFRAME
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME, res.A.d0_AA.d14.DATAFRAME, res.A.d0_AAA.d21.DATAFRAME), data.table)
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))
Amb.DEGs.IDs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
res.A.d0_AA.d7.DATAFRAME[1]
res.A.d0_AA.d7.DATAFRAME[5]
res.A.d0_AA.d7.DATAFRAME[6]
res.A.d0_AA.d7.DATAFRAME[7]
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME[7], res.A.d0_AA.d14.DATAFRAME[7], res.A.d0_AAA.d21.DATAFRAME[7]), data.table)
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
res.A.d0_AAA.d21.DATAFRAME
res.A.d0_AA.d14.DATAFRAME[7]
res.A.d0_AAA.d21.DATAFRAME[7]
Amb.DEGs
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID]
Amb.DEGs.IDs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)
Amb.DEGs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)['Gene.ID' %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs.IDs.keep
Amb.DEGs.keep <- Reduce(Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep <- Reduce(function, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep <- Reduce(f, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
?funion
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs.keep$Gene.ID
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.DATAFRAME[7], res.A.d0_AA.d14.DATAFRAME[7], res.A.d0_AAA.d21.DATAFRAME[7]), data.table)
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID]
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs.IDs.keep
Amb.DEGs
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N >=3L, 'Gene.ID']
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N >3L, 'Gene.ID']
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N =2L, 'Gene.ID']
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N = 3L, 'Gene.ID']
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N >= 3L, 'Gene.ID']
Amb.DEGs.IDs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs
Amb.DEGs.IDs.keep
res.A.d0_AA.d7.NS.GENES < - res.A.d0_AA.d7.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AA.d7.DATAFRAME
res.A.d0_AA.d7.NS.GENES <- res.A.d0_AA.d7.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AA.d14.NS.GENES <- res.A.d0_AA.d14.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AAA.d21.NS.GENES <- res.A.d0_AAA.d21.DATAFRAME %>%  dplyr::filter(padj > 0.05)
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.NS.GENES[7], res.A.d0_AA.d14.NS.GENES[7], res.A.d0_AAA.d21.NS.GENES[7]), data.table)
Amb.DEGs
sum(res.A.d0_AAA.d21$padj < 0.05, na.rm=TRUE) # 20 significant DEGs
res.A.d0_AAA.d21
sum(res.A.d0_AAA.d21$padj < 0.1, na.rm=TRUE) # 67 marginal DEGs
sum(res.A.d0_AAA.d21$padj < 0.05, na.rm=TRUE) # 20 significant DEGs
res.A.d0_AAA.d21.DATAFRAME <- as.data.frame(res.A.d0_AAA.d21)
res.A.d0_AAA.d21.DEGS <- res.A.d0_AAA.d21.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
res.A.d0_AAA.d21.DEGS
# View(res.A.d0_AAA.d21.DEGS) # 20 total DEGs
summary(res.A.d0_AAA.d21)
res.A.d0_AAA.d21.NS.GENES <- res.A.d0_AAA.d21.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AAA.d21.NS.GENES
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.NS.GENES[7], res.A.d0_AA.d14.NS.GENES[7], res.A.d0_AAA.d21.NS.GENES[7]), data.table)
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N >= 3L, 'Gene.ID']
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.NS.GENES[7], res.A.d0_AA.d14.NS.GENES[7], res.A.d0_AAA.d21.NS.GENES[7]), data.table)
res.A.d0_AAA.d21.NS.GENES[7]
res.A.d0_AAA.d21.NS.GENES
# what we find are a total of 26 significantly differentially expressed genes (p < 0.05)
# lets call these in a dataset for fun using the package 'data.frame'
res.A.d0_AA.d7.NS.GENES <- res.A.d0_AA.d7.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AA.d7.NS.GENES$Gene.ID <- row.names(res.A.d0_AA.d7.NS.GENES) # change row names to a column'Gene.ID'
res.A.d0_AA.d14.NS.GENES <- res.A.d0_AA.d14.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AA.d14.NS.GENES$Gene.ID <- row.names(res.A.d0_AA.d14.NS.GENES) # change row names to a column'Gene.ID'
res.A.d0_AAA.d21.NS.GENES <- res.A.d0_AAA.d21.DATAFRAME %>%  dplyr::filter(padj > 0.05)
res.A.d0_AAA.d21.NS.GENES$Gene.ID <- row.names(res.A.d0_AAA.d21.NS.GENES) # change row names to a column'Gene.ID'
Amb.DEGs <- lapply(list(res.A.d0_AA.d7.NS.GENES[7], res.A.d0_AA.d14.NS.GENES[7], res.A.d0_AAA.d21.NS.GENES[7]), data.table)
Amb.DEGs
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N >= 3L, 'Gene.ID']
Amb.DEGs.IDs.keep
Amb.DEGs.keep <- Reduce(funion, Amb.DEGs)[Gene.ID %in% Amb.DEGs.IDs.keep]
Amb.DEGs.keep
Amb.DEGs.IDs.keep
Amb.DEGs.IDs.keep <-rbindlist(lapply(Amb.DEGs, '[', j = 'Gene.ID'))[, .N, by=Gene.ID][N == 3L, 'Gene.ID']
Amb.DEGs.IDs.keep
res.A.d0_AAA.d21
sum(res.A.d0_AAA.d21$padj < 0.1, na.rm=TRUE) # 67 marginal DEGs
sum(res.A.d0_AAA.d21$padj < 0.05, na.rm=TRUE) # 20 significant DEGs
res.A.d0_AAA.d21.DATAFRAME <- as.data.frame(res.A.d0_AAA.d21)
res.A.d0_AAA.d21.DEGS <- res.A.d0_AAA.d21.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
res.A.d0_AAA.d21.DEGS
# View(res.A.d0_AAA.d21.DEGS) # 20 total DEGs
summary(res.A.d0_AAA.d21)
resultsNames(dds.all.treatments) # view the names of your results model
X <- as.data.frame(resultsNames(dds.all.treatments))
X
X.2 <- X[c(2:13),]
X.2
for (row in 1:nrow(X.2)) {
substring <- substr(row, 18, 22)
}
nrow(X.2)
X.2 <- X[c(2:13),]
X.2
X <- as.data.frame(resultsNames(dds.all.treatments))
X
X.2 <- as.data.frameX([c(2:13),])
X.2 <- as.data.frameX(X[c(2:13),])
X[c(2:13),]
X.2 <-  as.data.frameX(X.2)
X.2 <- X[c(2:13),]
X.2 <-  as.data.frameX(X.2)
X.2 <-  as.data.frame(X.2)
for (row in 1:nrow(X.2)) {
substring <- substr(row, 18, 22)
}
substring
X.2
substring <- substr(row$X.2, 18, 22)
for (row in 1:nrow(X.2)) {
substring <- substr(row[1], 18, 22)
}
substring
for (row in 1:nrow(X.2)) {
substring <- substr(row, 18, 22)
}
substring
substr(X.2$X.2[,1], 18, 22)
(X.2$X.2
X.2$X.2[,1]
X.2$X.2[1]
substr(X.2$X.2[1], 18, 22)
for (row in 1:nrow(X.2)) {
substring <- substr(X.2, 18, 22)
}
substring
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=i)
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=i),
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name="i")
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2)
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
RSLTS
dds.all.treatments
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i])
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name='X.2[i]')
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
substring
RSLTS
X.2[1]
X.2[,1]
X.2[1,]
RSLTS <- results(dds.all.treatments, name=X.2[1,]
RSLTS <- results(dds.all.treatments, name=X.2[1,])
RSLTS
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
}
RSLTS
df <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
df$sum <- sum
df$test <- X.2[i,]
}
df
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'sum')
in.loop.table$test <- X.2[i,]
in.loop.table$sum <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'sum')
in.loop.table$test <- X.2[i,]
in.loop.table$sum <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'sum')
in.loop.table$test <- X.2[i,]
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
RSLTS
nrow(RSLTS)
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 2))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
RSLTS
summary(RSLTS)
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
RSLTS.summary<- summary(RSLTS)
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
RSLTS.summary <- summary(RSLTS)
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
RSLTS.summary
summary(RSLTS)
RSLTS.summary
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
p <- summary(RSLTS)
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
p
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
p <- as.data.frame(summary(RSLTS))
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
p
summary(RSLTS)
summary(RSLTS)$LFC > 0
# for loop
df_total <- data.frame()
for (i in 1:nrow(X.2)) {
RSLTS <- results(dds.all.treatments, name=X.2[i,])
sum <- sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
Total.Genes <- nrow(RSLTS)
in.loop.table <- data.frame(matrix(nrow = 1, ncol = 3))
colnames(in.loop.table)<-c('test', 'total.genes', 'DEGs.p0.05')
in.loop.table$test <- X.2[i,]
in.loop.table$total.genes <- Total.Genes
in.loop.table$DEGs.p0.05 <- sum
df <- data.frame(in.loop.table)
df_total <- rbind(df_total,df)#bind to a cumulative list dataframe
}
df_total
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.A.d0_AA.d7 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d7","A.d0"))
sum(res.A.d0_AA.d7$padj < 0.1, na.rm=TRUE) # 1 marginal DEGs
sum(res.A.d0_AA.d7$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.A.d0_AA.d7.DATAFRAME <- as.data.frame(res.A.d0_AA.d7)
res.A.d0_AA.d7.DEGS <- res.A.d0_AA.d7.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
# View(res.A.d0_AA.d7.DEGS) # 1 total DEG
summary(res.A.d0_AA.d7)
sum(RSLTS$pvalue < 0.05, na.rm=TRUE)
results(dds.all.treatments, name=X.2[i,])
df_total
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.A.d0_AA.d7 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d7","A.d0"))
res.A.d0_AA.d7
sum(res.A.d0_AA.d7$padj < 0.1, na.rm=TRUE) # 1 marginal DEGs
sum(res.A.d0_AA.d7$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.A.d0_AA.d7.DATAFRAME <- as.data.frame(res.A.d0_AA.d7)
res.A.d0_AA.d7.DEGS <- res.A.d0_AA.d7.DATAFRAME  %>%  # downregulated genes under moderate stress
dplyr::filter(padj < 0.05)
# View(res.A.d0_AA.d7.DEGS) # 1 total DEG
summary(res.A.d0_AA.d7)
# Note: these are all different ways of looking at the same results...
res.ALL.TRMTS <- results(dds.all.treatments) # view DESeq2 result - calls the last pairwise condition
res.ALL.TRMTS <- results(dds.all.treatments, name="All_Treatment_MSM.d21_vs_A.d0")
res.ALL.TRMTS
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.ALL.TRMTS <- results(dds.all.treatments, name="All_Treatment_AA.d7_A.d0")
resultsNames(dds.all.treatments) # view the names of your results model
# A.d0_AA.d7 # Ambient Controls Day 0 compared to Day 7
res.ALL.TRMTS <- results(dds.all.treatments, name="All_Treatment_AA.d7_vs_A.d0")
res.ALL.TRMTS
sum(res.ALL.TRMTS$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.A.d0_AA.d7
sum(res.A.d0_AA.d7$padj < 0.05, na.rm=TRUE) # 1 significant DEGs
res.ALL.TRMTS
res.A.d0_AA.d7 <- results(dds.all.treatments, contrast=c("All_Treatment","AA.d7","A.d0"))
res.A.d0_AA.d7
