Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
# MODERATE second treatment
Day14.wgcna.frontloaded_genes_mod <- Day14_READY %>%
dplyr::filter(Day14.wgcna.xall_mod < 1) %>%
dplyr::filter(Day14.wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.xall_mod
# MODERATE second treatment
Day14.wgcna.frontloaded_genes_mod <- Day14_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                 = match(Day14.wgcna.frontloadprobes_mod, annot$V1)
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V14[probes2annot_mod])
probes2annot_mod                 = match(wgcna.frontloadprobes_mod, annot$V1)
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V14[probes2annot_mod])
Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                 = match(Day14.wgcna.frontloadprobes_mod, annot$V1)
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V14[probes2annot_mod])
probes2annot_mod
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V14[probes2annot_mod])
probes2annot_mod
Day14.wgcna.frontloadprobes_mod
Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                       = match(Day14.wgcna.frontloadprobes_mod, annot$V1)
annot$V1[probes2annot_mod]
annot$V14[probes2annot_mod]
annot$V14
annot
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day14.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day14.wgcna.frontloaded_genes_sev <- Day14_READY %>%
dplyr::filter(Day14.wgcna.xall_sev < 1) %>%
dplyr::filter(Day14.wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
# SEVERE second treatment
Day14.wgcna.frontloaded_genes_sev <- Day14_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_sev        = Day14.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                       = match(Day14.wgcna.frontloadprobes_sev, annot$V1)
Day14.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day14.wgcna.frontloaded_sev_ANNOT
library(ggplot2)
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 21)
par(mfrow=c(1,2))
P.wgcna.mod <- Day21_READY %>%
dplyr::select(!c('wgcna.xall_sev', 'wgcna.yall_sev')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod <- Day21_READY %>%
dplyr::select(!c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod <- Day21_READY %>%
dplyr::select(!c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
Day21_READY
Day21_READY %>%
dplyr::select(!c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point()
Day21_READY
Day21_READY %>%
dplyr::select(!c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit()
P.wgcna.mod <- Day21_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# plot the frontloaded genes formula using x axis for the severe treatment (second exposure, day 14)
P.wgcna.sev <- Day14_READY %>%
dplyr::select(c('wgcna.xall_sev', 'wgcna.yall_sev')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_sev < 3) %>%
ggplot(aes(x=wgcna.xall_sev, y=wgcna.yall_sev)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14 Frontloaded genes; response to severe pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.sev
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 21)
par(mfrow=c(1,2))
P.wgcna.mod <- Day21_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# MODERATE second treatment
Day21.wgcna.frontloaded_genes_mod <- Day21_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day21.wgcna.frontloadprobes_mod        = Day21.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                       = match(Day21.wgcna.frontloadprobes_mod, annot$V1)
Day21.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day21.wgcna.frontloaded_mod_ANNOT
# LOAD PACKAGES
library(dplyr)
library(reshape2)
library(ggplot2)
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/")
# LOAD DATA
annot = read.delim2(file = "Seq_details/Panopea-generosa-genes-annotations.txt",header = F) # annotation file P generosa
# WGCNA modules
day7.ModMem   <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day7/d7.WGCNA_ModulMembership.csv", sep=',', header=TRUE)   %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
day14.ModMem  <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day14/d14.WGCNA_ModulMembership.csv", sep=',', header=TRUE)  %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
day21.ModMem  <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day21/d21.WGCNA_ModulMembership.csv", sep=',', header=TRUE)  %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
# expression read counts
# Day 7
Day7_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day7/ Day7.PrimaryDEGs_AvM__DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# Day 14
Day14_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day14/ Day14.Primary_DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# Day 21
Day21_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day21/ Day21.Primary_DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# experiment metadata (treatments)
Day7_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190731) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
Day14_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190807) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
Day21_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190814) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
Day21_READY
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 7)
P.wgcna.mod <- Day7_READY %>%
dplyr::select(c('wgcna.xall_sev', 'wgcna.yall_sev')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 7
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
Day7_READY
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(Day7.wgcna.xall_mod < 1) %>%
dplyr::filter(Day7.wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day7.wgcna.frontloadprobes_mod        = Day7.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                 = match(Day7.wgcna.frontloadprobes_mod, annot$V1)
Day7.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day7.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day7.wgcna.frontloaded_genes_sev <- Day7_READY %>%
dplyr::filter(Day7.wgcna.xall_sev < 1) %>%
dplyr::filter(Day7.wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
# SEVERE second treatment
Day7.wgcna.frontloaded_genes_sev <- Day7_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
Day7.wgcna.frontloadprobes_sev        = Day7.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                      = match(Day7.wgcna.frontloadprobes_sev, annot$V1)
Day7.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day7.wgcna.frontloaded_sev_ANNOT
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day7.wgcna.frontloadprobes_mod        = Day7.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                      = match(Day7.wgcna.frontloadprobes_mod, annot$V1)
Day7.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day7.wgcna.frontloaded_mod_ANNOT
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day7.wgcna.frontloadprobes_mod        = Day7.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                      = match(Day7.wgcna.frontloadprobes_mod, annot$V1)
Day7.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day7.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day7.wgcna.frontloaded_genes_sev <- Day7_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
Day7.wgcna.frontloadprobes_sev        = Day7.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                      = match(Day7.wgcna.frontloadprobes_sev, annot$V1)
Day7.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day7.wgcna.frontloaded_sev_ANNOT
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 14)
par(mfrow=c(1,2))
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# plot the frontloaded genes formula using x axis for the severe treatment (second exposure, day 14)
P.wgcna.sev <- Day14_READY %>%
dplyr::select(c('wgcna.xall_sev', 'wgcna.yall_sev')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_sev < 3) %>%
ggplot(aes(x=wgcna.xall_sev, y=wgcna.yall_sev)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14 Frontloaded genes; response to severe pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.sev
# MODERATE second treatment
Day14.wgcna.frontloaded_genes_mod <- Day14_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                       = match(Day14.wgcna.frontloadprobes_mod, annot$V1)
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day14.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day14.wgcna.frontloaded_genes_sev <- Day14_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_sev        = Day14.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                       = match(Day14.wgcna.frontloadprobes_sev, annot$V1)
Day14.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day14.wgcna.frontloaded_sev_ANNOT
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 21)
par(mfrow=c(1,2))
P.wgcna.mod <- Day21_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 21)
par(mfrow=c(1,2))
P.wgcna.mod <- Day21_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 4.5,
alpha = .2) +
annotate("rect", xmin = 0, xmax = 1, ymin = 0, ymax = 1,
alpha = .5)
P.wgcna.mod
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene')
Day7.wgcna.frontloadprobes_mod        = Day7.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                      = match(Day7.wgcna.frontloadprobes_mod, annot$V1)
Day7.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day7.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day7.wgcna.frontloaded_genes_sev <- Day7_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene')
Day7.wgcna.frontloadprobes_sev        = Day7.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                      = match(Day7.wgcna.frontloadprobes_sev, annot$V1)
Day7.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day7.wgcna.frontloaded_sev_ANNOT
# MODERATE second treatment
Day7.wgcna.frontloaded_genes_mod <- Day7_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene')
Day7.wgcna.frontloadprobes_mod        = Day7.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                      = match(Day7.wgcna.frontloadprobes_mod, annot$V1)
Day7.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
Day7.wgcna.frontloaded_mod_ANNOT
# SEVERE second treatment
Day7.wgcna.frontloaded_genes_sev <- Day7_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene')
Day7.wgcna.frontloadprobes_sev        = Day7.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                      = match(Day7.wgcna.frontloadprobes_sev, annot$V1)
Day7.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
Day7.wgcna.frontloaded_sev_ANNOT
kable(Day7.wgcna.frontloaded_sev_ANNOT)
library(kableExtra)
library(knitr)
kable(Day7.wgcna.frontloaded_sev_ANNOT)
