png("Analysis/Output/WGCNA/Day21/Eigengene_Traits_plots.png", 500, 1000, pointsize=20)
par(mfrow=c(2,3))
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGDNAmodule:", module_color, "&",phys_type, sep =' '))
}
dev.off()
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
p
p + ggtitle(paste("WGDNAmodule:", module_color, "&",phys_type, sep =' '))
p + ggtitle(paste("WGDNAmodule:", module_color, "&",phys_type, sep =' '))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
png("Analysis/Output/WGCNA/Day21/Eigengene_Traits_plots.png", 500, 1000, pointsize=20)
par(mfrow=c(2,3))
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
dev.off()
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
par(mfrow=c(2,3))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
png("Analysis/Output/WGCNA/Day21/Eigengene_Traits_plots.png", 500, 1000, pointsize=20)
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
dev.off()
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
par(mfrow=c(2,3))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
png("Analysis/Output/WGCNA/Day21/Eigengene_Traits_plots.png", 500, 1000, pointsize=20)
dev.off()
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
png("Analysis/Output/WGCNA/Day21/Eigengene_Traits_plots.png", 500, 1000, pointsize=20)
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
dev.off()
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
dev.off()
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
library(gridExtra)
p[[i]]
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[i]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[i]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
do.call(grid.arrange,p)
par(mfrow=c(2,3))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[i]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[i]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
do.call(grid.arrange,p)
p[[i]]
p[[i]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[i]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[i]] <- p[[i]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
do.call(grid.arrange,p)
par(mfrow=c(2,3))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
}
do.call(grid.arrange,p)
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
do.call(grid.arrange,p)
}
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
plot_list[[m]] =  (grid.arrange(p))
print((plot_list[[i]]))
dev.off()
}
# lets loop this through to get a bunch of plots
phys <- d21_EigenTraitMaster[,c(36:41)]
modules <- d21_EigenTraitMaster[,c(2:28)]
par(mfrow=c(2,3))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
plot_list[[m]] =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",i,".jpg",sep=""), plot_list[[m]])
}
i
p[[m]]
plot_list[[m]] =  do.call(grid.arrange,p)
plot_list[[m]]
plot_list[[m]]
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
plot_list =  do.call(grid.arrange,p)
plot_list
plot_list
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",moduledata,".jpg",sep=""), plot_list)
}
ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]]
p
do.call(grid.arrange,p)
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",moduledata,".jpg",sep=""), do.call(grid.arrange,p))
}
moduledata
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
phys
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
legend(NULL) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw(legend.position = "none")
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' '))
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' ')) + theme(legend.position="none")
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
phys
par(mfrow=c(1,1))
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p[[m]] <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' ')) + theme(legend.position="none")
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' ')) + theme(legend.position="none")
p[[m]] <- p[[m]] + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' ')) + theme(legend.position="none")
for(i in 1:ncol(modules)) {
module_color <- substr(names(modules)[i], 3,12)
moduledata <- modules[,i]
for(m in 1:ncol(phys)) {
phys_type <- names(phys)[m]
physdata<- phys[,m]
p <- ggplot(d21_EigenTraitMaster,
aes(x=moduledata, y=physdata,
color = Primary_Treatment)) + # linetype= Primary_Treatment, group = Primary_Treatment
geom_smooth(method=lm , color="black",  fill="grey", se=TRUE, linetype = "dashed") + #, linetype = "dashed"
geom_point(size = 4, shape = 19) +
scale_color_manual(values=c("#56B4E9", "#D55E00")) +
labs(x="Eigengene expression by sample", y = paste(phys_type)) +
theme_bw()
p[[m]] <- p + ggtitle(paste("WGCNAmodule:", module_color, "&",phys_type, sep =' ')) + theme(legend.position="none")
}
# groid <- grid.arrange(plot_1, plot_1, plot_1,
#              plot_1, plot_1, plot_1, ncol=2, nrow = 3, clip="off")
# plot_list =  do.call(grid.arrange,p)
ggsave(filename=paste("Analysis/Output/WGCNA/Day21/myplot",module_color,".jpg",sep=""), do.call(grid.arrange,p))
}
