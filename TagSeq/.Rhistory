dplyr::mutate(Second_Treatment = substr(variable, 2,2)) %>%
# dplyr::group_by(Primary_Treatment, Third_Treatment) %>%
# dplyr::summarise(meanEXP = mean(value), sdExp = sd(value)) %>%
ggplot(aes(x=Second_Treatment , y=value, fill=Primary_Treatment)) +  # , colour=supp, group=supp))
theme_classic() +
#geom_errorbar(aes(ymin=meanEXP-sdExp, ymax=meanEXP+sdExp), colour="black", width=.1, position=pd) +
# geom_point(position=pd, size = 4, shape=21) +
geom_bar(position=position_dodge(), aes(y=value), stat="identity", width=0.5) +
xlab("Second pCO2 treatment") +
ylab('Gene Expression (averaged raw data)') +                 # note the mean was first by sample ID THEN by treatment
scale_fill_manual(values=c("grey85","grey50")) +
#scale_color_manual(values=c("#56B4E9","#E69F00")) +
# ggtitle(paste("Day 7:",apriori_DESeq2_condenced[i,1],":", apriori_DESeq2_condenced[i,3],sep='')) +
ggtitle(paste(  D14Frontloaded[i,1], gsub(" .*", "\\1", D14Frontloaded[i,2]), sep = '_') ) +
# expand_limits(y=0) +                                                    # Expand y range
# scale_y_continuous(limits=c((min_p1), (max_p1))) +
# scale_y_continuous(limits = c((max(sdExp)+0.5),(min(sdExp)-0.5)))  +
# ylim(ExpMin, ExpMin) +
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.ticks.length=unit(.25, "cm"))+
theme(legend.position = "none")
gene <- D14Frontloaded[i,1]
title <- gsub(" .*", "\\1", (sub(" ", "_",  D14Frontloaded[i,2])) )
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Frontloading_plots/Day14/",gene, "_", title,".pdf", sep = ''))
print(x2)
dev.off()
}
library(tidyverse)
for (i in 1:nrow(D14Frontloaded)) {
x <-  D14Frontloaded[i,]
x2 <- x  %>%
dplyr::select(!c("foldChangeRatioModerate","ControlRatioModerate","foldChangeRatioSevere","ControlRatioSevere","baseMeanNAIVE_control","baseMeanPRIMED_control","baseMeanNAIVE_foldChangeModerate","baseMeanPRIMED_foldChangeModerate" ,"baseMeanNAIVE_foldChangeSevere","baseMeanPRIMED_foldChangeSevere")) %>%
gather(variable, value, -c(Gene,Gene_Description)) %>%
dplyr::filter(variable %in% c('AA','AM','MA','MM')) %>%
dplyr::mutate(Primary_Treatment = substr(variable, 1,1)) %>%
dplyr::mutate(Second_Treatment = substr(variable, 2,2)) %>%
# dplyr::group_by(Primary_Treatment, Third_Treatment) %>%
# dplyr::summarise(meanEXP = mean(value), sdExp = sd(value)) %>%
ggplot(aes(x=Second_Treatment , y=value, fill=Primary_Treatment)) +  # , colour=supp, group=supp))
theme_classic() +
#geom_errorbar(aes(ymin=meanEXP-sdExp, ymax=meanEXP+sdExp), colour="black", width=.1, position=pd) +
# geom_point(position=pd, size = 4, shape=21) +
geom_bar(position=position_dodge(), aes(y=value), stat="identity", width=0.5) +
xlab("Second pCO2 treatment") +
ylab('Gene Expression (averaged raw data)') +                 # note the mean was first by sample ID THEN by treatment
scale_fill_manual(values=c("grey85","grey50")) +
#scale_color_manual(values=c("#56B4E9","#E69F00")) +
# ggtitle(paste("Day 7:",apriori_DESeq2_condenced[i,1],":", apriori_DESeq2_condenced[i,3],sep='')) +
ggtitle(paste(  D14Frontloaded[i,1], gsub(" .*", "\\1", D14Frontloaded[i,2]), sep = '_') ) +
# expand_limits(y=0) +                                                    # Expand y range
# scale_y_continuous(limits=c((min_p1), (max_p1))) +
# scale_y_continuous(limits = c((max(sdExp)+0.5),(min(sdExp)-0.5)))  +
# ylim(ExpMin, ExpMin) +
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.ticks.length=unit(.25, "cm"))+
theme(legend.position = "none")
gene <- D14Frontloaded[i,1]
title <- gsub(" .*", "\\1", (sub(" ", "_",  D14Frontloaded[i,2])) )
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Frontloading_plots/Day14/",gene, "_", title,".pdf", sep = ''))
print(x2)
dev.off()
}
(sub("/", "_",  title))
for (i in 1:nrow(D14Frontloaded)) {
x <-  D14Frontloaded[i,]
x2 <- x  %>%
dplyr::select(!c("foldChangeRatioModerate","ControlRatioModerate","foldChangeRatioSevere","ControlRatioSevere","baseMeanNAIVE_control","baseMeanPRIMED_control","baseMeanNAIVE_foldChangeModerate","baseMeanPRIMED_foldChangeModerate" ,"baseMeanNAIVE_foldChangeSevere","baseMeanPRIMED_foldChangeSevere")) %>%
gather(variable, value, -c(Gene,Gene_Description)) %>%
dplyr::filter(variable %in% c('AA','AM','MA','MM')) %>%
dplyr::mutate(Primary_Treatment = substr(variable, 1,1)) %>%
dplyr::mutate(Second_Treatment = substr(variable, 2,2)) %>%
# dplyr::group_by(Primary_Treatment, Third_Treatment) %>%
# dplyr::summarise(meanEXP = mean(value), sdExp = sd(value)) %>%
ggplot(aes(x=Second_Treatment , y=value, fill=Primary_Treatment)) +  # , colour=supp, group=supp))
theme_classic() +
#geom_errorbar(aes(ymin=meanEXP-sdExp, ymax=meanEXP+sdExp), colour="black", width=.1, position=pd) +
# geom_point(position=pd, size = 4, shape=21) +
geom_bar(position=position_dodge(), aes(y=value), stat="identity", width=0.5) +
xlab("Second pCO2 treatment") +
ylab('Gene Expression (averaged raw data)') +                 # note the mean was first by sample ID THEN by treatment
scale_fill_manual(values=c("grey85","grey50")) +
#scale_color_manual(values=c("#56B4E9","#E69F00")) +
# ggtitle(paste("Day 7:",apriori_DESeq2_condenced[i,1],":", apriori_DESeq2_condenced[i,3],sep='')) +
ggtitle(paste(  D14Frontloaded[i,1], gsub(" .*", "\\1", D14Frontloaded[i,2]), sep = '_') ) +
# expand_limits(y=0) +                                                    # Expand y range
# scale_y_continuous(limits=c((min_p1), (max_p1))) +
# scale_y_continuous(limits = c((max(sdExp)+0.5),(min(sdExp)-0.5)))  +
# ylim(ExpMin, ExpMin) +
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.ticks.length=unit(.25, "cm"))+
theme(legend.position = "none")
gene <- D14Frontloaded[i,1]
title <- gsub(" .*", "\\1", (sub(" ", "_",  D14Frontloaded[i,2])) )
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Frontloading_plots/Day14/",gene, "_", (sub("/", "_",  title)),".pdf", sep = ''))
print(x2)
dev.off()
}
Day7_Frontload_2
write.csv(Day7_Frontload_2,paste("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Day7_FrontloadedGenes.csv"))
D7Frontloaded <- Day7_Frontload_2 %>% filter(ControlRatioModerate > 1) %>% filter(foldChangeRatioModerate < 1)
for (i in 1:nrow(D7Frontloaded)) {
x <-  D7Frontloaded[i,]
x2 <- x  %>%
dplyr::select(!c("foldChangeRatioModerate","ControlRatioModerate","foldChangeRatioSevere","ControlRatioSevere","baseMeanNAIVE_control","baseMeanPRIMED_control","baseMeanNAIVE_foldChangeModerate","baseMeanPRIMED_foldChangeModerate" ,"baseMeanNAIVE_foldChangeSevere","baseMeanPRIMED_foldChangeSevere")) %>%
gather(variable, value, -c(Gene,Gene_Description)) %>%
dplyr::filter(variable %in% c('AA','AM','MA','MM')) %>%
dplyr::mutate(Primary_Treatment = substr(variable, 1,1)) %>%
dplyr::mutate(Second_Treatment = substr(variable, 2,2)) %>%
# dplyr::group_by(Primary_Treatment, Third_Treatment) %>%
# dplyr::summarise(meanEXP = mean(value), sdExp = sd(value)) %>%
ggplot(aes(x=Second_Treatment , y=value, fill=Primary_Treatment)) +  # , colour=supp, group=supp))
theme_classic() +
#geom_errorbar(aes(ymin=meanEXP-sdExp, ymax=meanEXP+sdExp), colour="black", width=.1, position=pd) +
# geom_point(position=pd, size = 4, shape=21) +
geom_bar(position=position_dodge(), aes(y=value), stat="identity", width=0.5) +
xlab("Second pCO2 treatment") +
ylab('Gene Expression (averaged raw data)') +                 # note the mean was first by sample ID THEN by treatment
scale_fill_manual(values=c("grey85","grey50")) +
#scale_color_manual(values=c("#56B4E9","#E69F00")) +
# ggtitle(paste("Day 7:",apriori_DESeq2_condenced[i,1],":", apriori_DESeq2_condenced[i,3],sep='')) +
ggtitle(paste(  D7Frontloaded[i,1], gsub(" .*", "\\1", D7Frontloaded[i,2]), sep = '_') ) +
# expand_limits(y=0) +                                                    # Expand y range
# scale_y_continuous(limits=c((min_p1), (max_p1))) +
# scale_y_continuous(limits = c((max(sdExp)+0.5),(min(sdExp)-0.5)))  +
# ylim(ExpMin, ExpMin) +
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.ticks.length=unit(.25, "cm"))+
theme(legend.position = "none")
gene <- D7Frontloaded[i,1]
title <- gsub(" .*", "\\1", (sub(" ", "_",  D7Frontloaded[i,2])) )
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Frontloading_plots/Day7/",gene,"_", (sub("/", "_",  title)),".pdf", sep = ''))
print(x2)
dev.off()
}
day21.blue
# Day 21 gene expression
Day_WGCNA_genes <- Day21_exp_data %>%
dplyr::filter(Gene %in% (rbind(day21.blue, day21.magenta))) # call all genes in the module
Day_WGCNA_genes
(rbind(day21.blue, day21.magenta))
day21.blue
day21.magenta
# Day 21 gene expression
day21.blue_magenta <- rbind(day21.blue, day21.magenta)
day21.blue_magenta
day21.blue
day21.magenta
# Day 21 gene expression
day21.blue_magenta <- rbind(day21.blue, day21.magenta)
# Day 21 gene expression
VieW(day21.blue_magenta)
Day_WGCNA_genes <- Day21_exp_data %>%
dplyr::filter(Gene %in% day21.blue_magenta) # call all genes in the module
Day_WGCNA_genes
# Day 21 gene expression
day21.blue_magenta <- rbind(day21.blue, day21.magenta)
Day_WGCNA_genes <- Day21_exp_data %>%
dplyr::filter(Gene %in% day21.blue_magenta) # call all genes in the module
Day_WGCNA_genes
day21.blue_magenta
# Day 21 gene expression
day21.blue_magenta <- rbind(day21.blue, day21.magenta)
Day_WGCNA_genes <- Day21_exp_data %>%
dplyr::filter(Gene %in% day21.blue_magenta$Pgen_ID) # call all genes in the module
#dplyr::filter(Gene %in% NaiveResponse_genes)
Day21_WGCNA_genes_melted     <- Day_WGCNA_genes %>%
reshape2::melt(id.var = 'Gene') %>%
dplyr::rename(Sample.Name = variable)
Day21_WGCNA_genes_Merge <- merge(Day21_WGCNA_genes_melted, Day21_Master.Exp.Metadata, by = 'Sample.Name') %>%
dplyr::group_by(Gene, All_Treatment) %>%
dplyr::select(!'Sample.Name') %>%
dplyr::summarise(meanExp = mean(value))
Day21_READY <- dcast(Day21_WGCNA_genes_Merge, Gene ~ All_Treatment)
Day21_READY
for (i in 1:nrow(Day21_READY)) {
# Moderate - higher expression AM > AA
if (Day21_READY$AAM[i] > Day21_READY$AAA[i]) {
Day21_READY$wgcna.xall_mod[i] <- ( (Day21_READY$MAM[i] / Day21_READY$MAA[i]) / (Day21_READY$AAM[i] / Day21_READY$AAA[i]) ) # call MA as the control for MM ratio
Day21_READY$wgcna.yall_mod[i] <- (Day21_READY$MAA[i] / Day21_READY$AAA[i]) # Y Axis - this is simply the conditioned control over the naive control ( MA / AA )
} else {
Day21_READY$wgcna.xall_mod[i] <- NA  # X axis  - call NA
Day21_READY$wgcna.yall_mod[i] <- NA # Y Axis  - call NA
}
}
x = data.frame(Gene = annot$V1[(match(Day21_READY$Gene, annot$V1))],
Gene_Description = annot$V7[(match(Day21_READY$Gene, annot$V1))])
Day21_Frontload   <- merge(x, Day21_READY, by = 'Gene')
Day21_Frontload_2 <- Day21_Frontload %>%
dplyr::mutate(baseMeanNAIVE_control = AAA) %>%
dplyr::mutate(baseMeanPRIMED_control = MAA) %>%
dplyr::mutate(baseMeanNAIVE_foldChangeModerate = ((AAM) / (AAA))  ) %>%
dplyr::mutate(baseMeanPRIMED_foldChangeModerate = ((MAM) / (MAA)) ) %>%
dplyr::rename(ControlRatio = wgcna.yall_mod) %>%
dplyr::rename(foldChangeRatio = wgcna.xall_mod)
write.csv(Day21_Frontload_2,paste("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Day21_FrontloadedGenes.csv"))
D21Frontloaded <- Day21_Frontload_2 %>% filter(ControlRatio > 1) %>% filter(foldChangeRatio < 1)
for (i in 1:nrow(D21Frontloaded)) {
x <-  D21Frontloaded[i,]
x2 <- x  %>%
dplyr::select(!c('foldChangeRatio','ControlRatio','baseMeanNAIVE_control','baseMeanPRIMED_control','baseMeanNAIVE_foldChangeModerate','baseMeanPRIMED_foldChangeModerate')) %>%
gather(variable, value, -c(Gene,Gene_Description)) %>%
dplyr::filter(variable %in% c('AAA','AAM','MAA','MAM')) %>%
dplyr::mutate(Primary_Treatment = substr(variable, 1,1)) %>%
dplyr::mutate(Second_Treatment = substr(variable, 2,2)) %>%
dplyr::mutate(Third_Treatment = substr(variable, 3,3)) %>%
# dplyr::group_by(Primary_Treatment, Third_Treatment) %>%
# dplyr::summarise(meanEXP = mean(value), sdExp = sd(value)) %>%
ggplot(aes(x=Third_Treatment , y=value, fill=Primary_Treatment)) +  # , colour=supp, group=supp))
theme_classic() +
#geom_errorbar(aes(ymin=meanEXP-sdExp, ymax=meanEXP+sdExp), colour="black", width=.1, position=pd) +
# geom_point(position=pd, size = 4, shape=21) +
geom_bar(position=position_dodge(), aes(y=value), stat="identity", width=0.5) +
xlab("Third pCO2 treatment") +
ylab('Gene Expression (averaged raw data)') +                 # note the mean was first by sample ID THEN by treatment
scale_fill_manual(values=c("grey85","grey50")) +
#scale_color_manual(values=c("#56B4E9","#E69F00")) +
# ggtitle(paste("Day 7:",apriori_DESeq2_condenced[i,1],":", apriori_DESeq2_condenced[i,3],sep='')) +
ggtitle(paste(  D21Frontloaded[i,1], gsub(" .*", "\\1", D21Frontloaded[i,2]), sep = '_') ) +
# expand_limits(y=0) +                                                    # Expand y range
# scale_y_continuous(limits=c((min_p1), (max_p1))) +
# scale_y_continuous(limits = c((max(sdExp)+0.5),(min(sdExp)-0.5)))  +
# ylim(ExpMin, ExpMin) +
theme(axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.ticks.length=unit(.25, "cm"))+
theme(legend.position = "none")
gene <- D21Frontloaded[i,1]
title <- gsub(" .*", "\\1", (sub(" ", "_",  D21Frontloaded[i,2])) )
pdf(paste0("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Frontloading_plots/Day21/",gene, "_", (sub("/", "_",  title)),".pdf", sep = ''))
print(x2)
dev.off()
}
D21Frontloaded <- Day21_Frontload_2 %>% filter(ControlRatio > 1) %>% filter(foldChangeRatio < 1)
D21Frontloaded
Day14.wgcna.frontloaded_genes_mod <- Day14_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_mod        = Day14.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                       = match(Day14.wgcna.frontloadprobes_mod, annot$V1)
Day14.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
kable(Day14.wgcna.frontloaded_mod_ANNOT)
# SEVERE second treatment
Day14.wgcna.frontloaded_genes_sev <- Day14_READY %>%
dplyr::filter(wgcna.xall_sev < 1) %>%
dplyr::filter(wgcna.yall_sev > 1) %>%
dplyr::select('Gene') # %>%
Day14.wgcna.frontloadprobes_sev        = Day14.wgcna.frontloaded_genes_sev$Gene
probes2annot_sev                       = match(Day14.wgcna.frontloadprobes_sev, annot$V1)
Day14.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
kable(Day14.wgcna.frontloaded_sev_ANNOT)
P.wgcna.mod <- Day21_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.yall_mod < 4) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 21
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 4.5,
alpha = .2)
P.wgcna.mod
# MODERATE second treatment
Day21.wgcna.frontloaded_genes_mod <- Day21_READY %>%
dplyr::filter(wgcna.xall_mod < 1) %>%
dplyr::filter(wgcna.yall_mod > 1) %>%
dplyr::select('Gene') # %>%
Day21.wgcna.frontloadprobes_mod        = Day21.wgcna.frontloaded_genes_mod$Gene
probes2annot_mod                       = match(Day21.wgcna.frontloadprobes_mod, annot$V1)
Day21.wgcna.frontloaded_mod_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_mod],
Genes = annot$V7[probes2annot_mod])
kable(Day21.wgcna.frontloaded_mod_ANNOT)
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day14.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(Genes))
# plot the frontloaded genes formula using x axis for the severe treatment (second exposure, day 14)
P.wgcna.sev <- Day14_READY %>%
dplyr::select(c('wgcna.xall_sev', 'wgcna.yall_sev')) %>%
dplyr::filter(wgcna.xall_sev < 4) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_sev < 3) %>%
ggplot(aes(x=wgcna.xall_sev, y=wgcna.yall_sev)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14 Frontloaded genes; response to severe pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2)
P.wgcna.sev
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 14)
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2)
P.wgcna.mod
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 14)
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.xall_sev < 4) %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2)
# plot the frontloaded genes formula using x axis for the moderate treatment (second exposure, day 14)
P.wgcna.mod <- Day14_READY %>%
dplyr::select(c('wgcna.xall_mod', 'wgcna.yall_mod')) %>%
na.omit() %>%
dplyr::filter(wgcna.xall_mod < 4) %>%
#dplyr::filter(wgcna.yall_mod < 3) %>%
ggplot(aes(x=wgcna.xall_mod, y=wgcna.yall_mod)) +
geom_point() +
theme_classic() +
stat_smooth(method = "lm",
formula = y ~ x + poly(x, 2) - 1) +
geom_vline(xintercept=1, linetype="dotted") +
geom_hline(yintercept=1, linetype="dotted") +
labs(y= "Conditioned to naive control ratio",
x = "Conditioned to naive foldchange ratio",
title = "Day 14
Frontloaded genes; response to moderate pCO2") +
expand_limits(x = 0, y = 0) +
annotate("rect", xmin = 0, xmax = 1, ymin = 1, ymax = 1.5,
alpha = .2)
P.wgcna.mod
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day14.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT)
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day14.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol
))
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day14.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::summarise(n = n(geneSymbol)))
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day14.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol))
Day14.wgcna.frontloaded_mod_ANNOT
kable(head(Day14.wgcna.frontloaded_mod_ANNOT))
print("Total frontloaded genes = ",nrow(Day14.wgcna.frontloaded_mod_ANNOT)
print("Total frontloaded genes = ",nrow(Day14.wgcna.frontloaded_mod_ANNOT))
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_mod_ANNOT)), sep = '')
kable(head(Day14.wgcna.frontloaded_sev_ANNOT))
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_sev_ANNOT)), sep = '')
nrow(Day21.wgcna.frontloaded_mod_ANNOT))
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), sep = '')
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =" (  (nrow(Day21.wgcna.frontloaded_mod_ANNOT)/nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100)   ), sep = '')
(nrow(day21.blue_magenta))
(nrow(Day21.wgcna.frontloaded_mod_ANNOT)/nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100)
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =" ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)/nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100), sep = '')
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =", ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)/nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100), sep = '')
((nrow(Day21.wgcna.frontloaded_mod_ANNOT)/nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100)
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =", ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)-(nrow(day21.blue_magenta)) / (nrow(day21.blue_magenta)) * 100), sep = '')
((nrow(Day21.wgcna.frontloaded_mod_ANNOT)) - (nrow(day21.blue_magenta)))
(nrow(day21.blue_magenta))
(nrow(Day21.wgcna.frontloaded_mod_ANNOT))
( ( (nrow(day21.blue_magenta)) - ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100)
( (nrow(day21.blue_magenta)) - ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)) )
(nrow(day21.blue_magenta))
(nrow(day21.blue_magenta)) - ((nrow(Day21.wgcna.frontloaded_mod_ANNOT))
( (nrow(day21.blue_magenta)) - ((nrow(Day21.wgcna.frontloaded_mod_ANNOT)) )
( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) )
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =", ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100), sep = '')
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =", ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta))  * 100), sep = '')
( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) )
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) =", ( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100), sep = '')
( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) = ", ( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100), sep = '')
( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100)
perc_mod21 <- ( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) = ",perc_mod21 , sep = '')
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT)), "; Percent of naive module(s) = ",perc_mod21 , sep = '')
perc_mod21
perc_mod21 <- ( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module(s) = ",perc_mod21 , sep = '')
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module(s) = ",perc_mod21 , sep = ''))
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module(s) = ", ( ( ( (nrow(day21.blue_magenta)) - (nrow(Day21.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day21.blue_magenta)) ) * 100) , sep = ''))
perc_mod14_sev <- ( ( ( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day14.brown)) ) * 100)
perc_mod14_sev
(nrow(Day14.wgcna.frontloaded_sev_ANNOT))
(nrow(day14.brown))
perc_mod14_sev <- ( ( ( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day14.brown)) ) * 100)
perc_mod14_sev
( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day14.brown))
(nrow(Day14.wgcna.frontloaded_sev_ANNOT))
(nrow(day14.brown))
perc_mod14_sev <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day14.brown)) ) * 100)
perc_mod14_sev
print(paste("Total frontloaded genes = ", nrow(Day21.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module(s) = ",perc_mod21 , sep = ''))
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_sev_ANNOT)), "; Percent of naive module(s) = ",perc_mod14_sev ,  sep = '')
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_sev_ANNOT), "; Percent of naive module(s) = ",perc_mod14_sev ,  sep = '')
nrow(Day14.wgcna.frontloaded_sev_ANNOT)
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_sev_ANNOT), "; Percent of naive module(s) = ",perc_mod14_sev ,  sep = ''))
perc_mod14_sev <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day14.brown)) ) * 100)
perc_mod14_mod <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day14.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day14.brown)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day14.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module = ",perc_mod14_mod ,  sep = ''))
perc_mod7_sev <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day7.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
Day7.wgcna.frontloaded_sev_ANNOT      = data.frame(geneSymbol = annot$V1[probes2annot_sev],
Genes = annot$V7[probes2annot_sev])
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_sev_ANNOT)), sep = '')
perc_mod7_sev <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day7.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_sev_ANNOT), "; Percent of naive module = ",perc_mod7_sev ,  sep = ''))
(nrow(day7.brown))
(nrow(Day7.wgcna.frontloaded_sev_ANNOT))
perc_mod7_sev <- 100 -( ( ( (nrow(day14.brown)) - (nrow(Day7.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
perc_mod7_sev
( ( ( (nrow(day14.brown)) - (nrow(Day7.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
(nrow(day14.brown))
perc_mod7_sev <- 100 -( ( ( (nrow(day7.brown)) - (nrow(Day7.wgcna.frontloaded_sev_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_sev_ANNOT), "; Percent of naive module = ",perc_mod7_sev ,  sep = ''))
kable(head(Day7.wgcna.frontloaded_mod_ANNOT))
perc_mod7_mod <- 100 -( ( ( (nrow(day7.brown)) - (nrow(Day7.wgcna.frontloaded_mod_ANNOT)) ) / (nrow(day7.brown)) ) * 100)
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module = ",perc_mod7_mod ,  sep = ''))
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_sev_ANNOT), "; Percent of naive module = ",perc_mod7_sev ,  sep = ''))
print(paste("Total frontloaded genes = ", nrow(Day7.wgcna.frontloaded_mod_ANNOT), "; Percent of naive module = ",perc_mod7_mod ,  sep = ''))
# LOAD PACKAGES
library(dplyr)
library(reshape2)
library(ggplot2)
library(kableExtra)
library(knitr)
library(tidyverse)
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/")
# LOAD DATA
annot = read.delim2(file = "Seq_details/Panopea-generosa-genes-annotations.txt",header = F) # annotation file P generosa
# WGCNA modules
day7.ModMem   <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day7/d7.WGCNA_ModulMembership.csv", sep=',', header=TRUE)   %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
day14.ModMem  <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day14/d14.WGCNA_ModulMembership.csv", sep=',', header=TRUE)  %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
day21.ModMem  <- read.csv(file="Analysis/Output/WGCNA/subseq_treatments_all/Day21/d21.WGCNA_ModulMembership.csv", sep=',', header=TRUE)  %>%  dplyr::rename(Pgen_ID = X) %>%  mutate(Pgen_ID = as.character(Pgen_ID)) %>%  dplyr::select(c('Pgen_ID','moduleColor'))
# expression read counts
# Day 7
Day7_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day7/ Day7.PrimaryDEGs_AvM__DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# Day 14
Day14_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day14/ Day14.Primary_DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# Day 21
Day21_exp_data <- read.csv(file="Analysis/Output/DESeq2/10cpm/Day21/ Day21.Primary_DESeq2results.csv", sep=',', header=TRUE) %>% dplyr::select(!c('X','baseMean','log2FoldChange','lfcSE','stat','pvalue','padj'))
# experiment metadata (treatments)
Day7_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190731) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
Day14_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190807) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
Day21_Master.Exp.Metadata   <- read.csv(file="Analysis/Data/Experiment_Metadata/Master_Phyenotype.and.Exp.Treatment_Metadata.csv", sep=',', header=TRUE) %>%
dplyr::filter(Date %in% 20190814) %>% # call only day 7
dplyr::select(c('Sample.Name', 'All_Treatment')) %>% # select only the sample names and the treatment groups
dplyr::mutate(All_Treatment = factor(All_Treatment)) # make the treatment groups a factor
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol))
View(rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT))
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol)
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol) %>%
dplyr::filter(n ==2)
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol, Gene) %>%
dplyr::filter(n ==2)
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT)
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol, Genes)
rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol, Genes) %>%
dplyr::filter(n ==2)
Frontloaded_ModerateExposures <- rbind(Day7.wgcna.frontloaded_mod_ANNOT, Day21.wgcna.frontloaded_mod_ANNOT) %>%
dplyr::count(geneSymbol, Genes) %>%
dplyr::filter(n ==2) %>%
select(!n)
write.csv(Frontloaded_ModerateExposures,paste("C:/Users/samjg/Documents/Github_repositories/Pgenerosa_TagSeq_Metabolomics/TagSeq/Analysis/Output/WGCNA/subseq_treatments_all/Day7and21_FrontloadedGenes.csv"))
